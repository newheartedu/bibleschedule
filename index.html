<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PJBC è®€ç¶“é€²åº¦</title>
    <meta name="description" content="PJBC å¹³é®æµ¸ä¿¡æœƒ æ¯æ—¥è®€ç¶“é€²åº¦æŸ¥è©¢">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    screens: {
                        'print': {'raw': 'print'},
                    },
                    animation: {
                        'fade-in-up': 'fadeInUp 0.5s ease-out forwards',
                        'bounce-short': 'bounceShort 1s ease-in-out 1'
                    },
                    keyframes: {
                        fadeInUp: {
                            '0%': { opacity: '0', transform: 'translateY(10px) translateX(-50%)' },
                            '100%': { opacity: '1', transform: 'translateY(0) translateX(-50%)' },
                        },
                        bounceShort: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <!-- å¼•å…¥ html2pdf.js èˆ‡ html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- å¼•å…¥ JSZip ç”¨æ–¼å¤šåœ–æ‰“åŒ…ä¸‹è¼‰ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.294.0"
      }
    }
    </script>
    
    <!-- å¼•å…¥ Google Fonts: Noto Serif TC (åˆ—å°èˆ‡æ¨™é¡Œç”¨) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700;900&family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        /* --- ç¶²ç«™é è¨­å­—é«” (ä¸æ”¹è®Š) --- */
        body {
            background-color: #F9F9F7;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans TC", sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #cbd5e1; border-radius: 20px; }
        
        /* ç¥ç¦å¡ç‰‡å°ˆç”¨å­—é«” */
        .font-serif-tc {
            font-family: 'Noto Serif TC', serif;
        }

        /* --- åˆ—å°èˆ‡é è¦½å°ˆç”¨æ¨£å¼ (Print Styles) --- */
        @page {
            size: A4 portrait;
            margin: 0;
        }

        .print-page-container {
            width: 210mm;
            height: 296mm;
            padding: 12mm 15mm;
            background: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin: 0 auto 20px auto;
            box-sizing: border-box;
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            page-break-after: always;
            font-family: 'Noto Serif TC', serif;
            color: #000;
        }

        .print-page-container:last-child {
            page-break-after: auto;
            margin-bottom: 0;
        }

        .print-header {
            border-bottom: 3px double #000;
            padding-bottom: 10px;
            margin-bottom: 12px;
            text-align: center;
        }

        .print-title {
            font-size: 36px;
            font-weight: 900;
            color: #000;
            letter-spacing: 2px;
            line-height: 1.1;
            margin-bottom: 4px;
            text-shadow: 0.5px 0 0 currentColor; 
        }

        .print-subtitle {
            font-size: 20px;
            font-weight: 700;
            letter-spacing: 4px;
            color: #222;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .print-subtitle::before,
        .print-subtitle::after {
            content: "";
            display: block;
            width: 30px;
            height: 1px;
            background: #444;
        }

        .print-meta {
            position: absolute;
            right: 15mm;
            text-align: right;
            font-family: 'Noto Sans TC', sans-serif;
            color: #000;
        }
        
        .print-meta-year { font-size: 14px; font-weight: bold; }
        .print-meta-month { font-size: 36px; font-weight: 900; line-height: 0.9; }

        .table-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            width: 100%;
            overflow: hidden;
        }

        .design-table {
            width: 100%;
            height: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }
        
        .design-table th {
            background-color: #f0f0f0;
            border-top: 2px solid #000;
            border-bottom: 2px solid #000;
            border-left: 1px solid #ccc;
            border-right: 1px solid #ccc;
            padding: 4px;
            font-weight: 800;
            text-align: center;
            font-size: 16px;
            font-family: 'Noto Sans TC', sans-serif;
            height: 36px;
            color: #000;
        }

        .design-table th:first-child { border-left: none; }
        .design-table th:last-child { border-right: none; }

        .design-table td {
            border-bottom: 1px solid #ddd;
            border-left: 1px solid #eee;
            border-right: 1px solid #eee;
            vertical-align: middle;
            padding: 0 6px;
        }

        .design-table tr:last-child td { border-bottom: 2px solid #000; }
        .design-table tr:nth-child(even) { background-color: #fafafa; }

        .cell-date { text-align: center; font-family: 'Noto Sans TC', sans-serif; font-weight: 700; font-size: 16px; color: #000; }
        .cell-weekday { font-size: 12px; font-weight: normal; color: #444; margin-left: 4px; }
        .cell-scripture { font-size: 13px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: clip; letter-spacing: 0.5px; color: #000; }
        .cell-check { text-align: center; padding: 0; }

        .design-checkbox {
            width: 16px;
            height: 16px;
            border: 1.5px solid #333;
            border-radius: 3px;
            margin: 0 auto;
        }

        .print-footer {
            margin-top: 8px;
            font-size: 10px;
            color: #666;
            text-align: center;
            font-family: 'Noto Sans TC', sans-serif;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 12px;
        }

        @media print {
            body { background: white; margin: 0; padding: 0; }
            body > *:not(#print-preview-root) { display: none !important; }
            #print-preview-root { display: block !important; position: static !important; width: 100%; height: auto; overflow: visible !important; background: white; }
            .no-print-in-preview { display: none !important; }
            .print-page-container { box-shadow: none; margin: 0; width: 210mm; height: 296mm; page-break-after: always; break-after: page; overflow: hidden; }
            .print-page-container:last-child { page-break-after: auto; break-after: auto; height: auto; min-height: 296mm; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <div id="print-preview-root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useMemo, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
          Calendar as CalendarIcon, List, Home, Settings, ChevronLeft, ChevronRight, CheckCircle, Circle, 
          Star, BookOpen, Edit3, X, Search, Download, RefreshCw, Sparkles, Bookmark, Book, ArrowRight, 
          TrendingUp, LayoutGrid, Sun, Globe, Printer, Eye, FileDown, Image as ImageIcon, FileText, Fish,
          Map, Award, Anchor, Milestone, Lock, Gift, Bell, User
        } from 'lucide-react';

        // --- æ—…ç¨‹è³‡æ–™åº« (æ›´æ–°ï¼šåŠ å…¥æ€§åˆ¥ gender: 'm' | 'f') ---
        const JOURNEY_DATA = {
            characters: [
                { id: 1, stars: 3, name: "äºä¼¯æ‹‰ç½•", gender: 'm', theme: "ä¿¡å¿ƒä¹‹çˆ¶", blessing: "é¡˜ä½ åœ¨æœªçŸ¥çš„æ—…é€”ä¸­ï¼Œä¾ç„¶ä¿¡é ç¥çš„æ‡‰è¨±ï¼Œå› ç‚ºç¥‚æ˜¯ä¿¡å¯¦çš„ã€‚" },
                { id: 2, stars: 6, name: "ç´„ç‘Ÿ", gender: 'm', theme: "ç¥æ—¨æ„çš„ç¾å¥½", blessing: "ç„¡è«–è™•åœ¨é«˜å±±æˆ–ä½è°·ï¼Œé¡˜ä½ æ·±ä¿¡ç¥çš„æ„æ€åŸæ˜¯å¥½çš„ï¼Œç¥‚å¿…è¦ªè‡ªå¼•é ˜ã€‚" },
                { id: 3, stars: 9, name: "æ‘©è¥¿", gender: 'm', theme: "è¬™å’Œèˆ‡å¿ å¿ƒ", blessing: "é¡˜ç¥è³œä½ æº«æŸ”çš„å¿ƒèˆ‡å …å®šçš„éˆï¼Œåœ¨æ—¥å¸¸çš„å°äº‹ä¸Šé¡¯å‡ºå¤§å¿ å¿ƒã€‚" },
                { id: 4, stars: 12, name: "è·¯å¾—", gender: 'f', theme: "å …å®šçš„è·Ÿéš¨", blessing: "é¡˜ä½ çš„å¿ƒå–®ç´”è€Œå …å®šï¼Œåœ¨å¹³å‡¡çš„æ‹¾ç©—ä¸­ï¼Œé‡è¦‹ç¥é å‚™çš„è±ç››æ©å…¸ã€‚" },
                { id: 5, stars: 15, name: "å¤§è¡›", gender: 'm', theme: "åˆç¥å¿ƒæ„", blessing: "é¡˜ä½ åƒå¤§è¡›ä¸€æ¨£ï¼Œåœ¨è»Ÿå¼±æ™‚æ‡‚å¾—å€šé ï¼Œåœ¨å¾—å‹æ™‚æ‡‚å¾—æ­¸æ¦®è€€çµ¦ç¥ã€‚" },
                { id: 6, stars: 18, name: "ä»¥æ–¯å¸–", gender: 'f', theme: "å‹‡æ•¢çš„ä½ä»½", blessing: "é¡˜ä½ çŸ¥é“ä½ å¾—è‘—ä»Šæ—¥çš„ä½ä»½ï¼Œæ˜¯ç‚ºäº†ç¥åœ‹åº¦çš„ç·£æ•…ï¼Œå‰›å¼·å£¯è†½å§ï¼" },
                { id: 7, stars: 21, name: "å½¼å¾—", gender: 'm', theme: "è·Œå€’å¾Œçš„æ›´æ–°", blessing: "å³ä½¿æ›¾ç¶“è»Ÿå¼±ï¼Œä¸»çš„æ„›ä¾ç„¶å°‹æ‰¾ä½ ã€‚é¡˜ä½ å†æ¬¡è¢«æ„›å……æ»¿ï¼Œç‰§é¤Šç¥‚çš„ç¾Šã€‚" },
                { id: 8, stars: 24, name: "ä¿ç¾…", gender: 'm', theme: "å¥”è·‘ä¸æ”¾æ£„", blessing: "å¿˜è¨˜èƒŒå¾Œï¼ŒåŠªåŠ›é¢å‰ï¼Œé¡˜ä½ å‘è‘—æ¨™ç«¿ç›´è·‘ï¼Œå¾—è‘—ç¥åœ¨åŸºç£è€¶ç©Œè£¡å¬ä½ å¾—çš„çè³ã€‚" },
                { id: 9, stars: 27, name: "ç´„ç¿°", gender: 'm', theme: "æ„›çš„ä½¿å¾’", blessing: "é¡˜ä½ ä½åœ¨æ„›è£¡é¢ï¼Œä¸åƒ…è¢«æ„›ï¼Œæ›´èƒ½æˆç‚ºæµé€šç¥æ„›çš„å™¨çš¿ã€‚" },
                { id: 10, stars: 30, name: "é¦¬åˆ©äº", gender: 'f', theme: "å°Šä¸»ç‚ºå¤§", blessing: "é¡˜ä½ çš„å¿ƒå°Šä¸»ç‚ºå¤§ï¼Œéˆä»¥ç¥ç‚ºæ¨‚ï¼Œé †æœç¥è©±èªçš„æˆå°±ã€‚" }
            ],
            locations: [
                { id: 1, stars: 7, name: "ä¼Šç”¸åœ’", theme: "èµ·åˆçš„æ„›", meditation: "å›åˆ°èµ·åˆï¼Œç¥çœ‹ä¸€åˆ‡éƒ½ç”šå¥½ã€‚é¡˜ä½ åœ¨å¿™ç¢Œä¸­ï¼Œæ‰¾å›èˆ‡ç¥åŒè¡Œçš„å–®ç´”å¿«æ¨‚ã€‚" },
                { id: 2, stars: 14, name: "äºæ‹‰è‡˜å±±", theme: "æ–°çš„é–‹å§‹", meditation: "æ´ªæ°´é€€å»ï¼Œå½©è™¹ç«‹ç´„ã€‚é¡˜èˆŠäº‹å·²éï¼Œä½ çš„ç”Ÿå‘½åœ¨åŸºç£è£¡æˆç‚ºæ–°é€ çš„äººã€‚" },
                { id: 3, stars: 21, name: "å¾ç¥", theme: "å‘¼å¬ä¹‹åœ°", meditation: "é›¢é–‹æœ¬åœ°æœ¬æ—ï¼Œä¸æ˜¯æµæµªï¼Œè€Œæ˜¯è·Ÿéš¨ã€‚é¡˜ä½ è½è¦‹é‚£æº«æŸ”çš„å‘¼å–šï¼Œå‹‡æ•¢èµ·è¡Œã€‚" },
                { id: 4, stars: 28, name: "ç´…æµ·", theme: "ç¥è¹Ÿèˆ‡æ‹¯æ•‘", meditation: "å‰æœ‰ç´…æµ·ï¼Œå¾Œæœ‰è¿½å…µï¼Œæ­£æ˜¯ç¥é¡¯æ¦®è€€çš„æ™‚åˆ»ã€‚åªç®¡ç«™ä½ï¼Œçœ‹è€¶å’Œè¯ç‚ºä½ æ–½è¡Œæ•‘æ©ã€‚" },
                { id: 5, stars: 35, name: "è¥¿å¥ˆå±±", theme: "è–æ½”ä¹‹ç´„", meditation: "ç¥çš„è©±èªæ˜¯è…³å‰çš„ç‡ˆã€‚é¡˜ä½ åœ¨å±±ä¸Šé ˜å—çš„äº®å…‰ï¼Œæˆç‚ºå±±ä¸‹è¡Œèµ°çš„æº–å‰‡ã€‚" },
                { id: 6, stars: 42, name: "è¿¦å—åœ°", theme: "æ‡‰è¨±ä¹‹åœ°", meditation: "æµå¥¶èˆ‡èœœä¹‹åœ°éœ€è¦çˆ­æˆ°å¾—åœ°ç‚ºæ¥­ã€‚é¡˜ä½ å‰›å¼·å£¯è†½ï¼Œä¸çœ‹å·¨äººçš„é«˜å¤§ï¼Œåªçœ‹ç¥çš„æ‡‰è¨±ã€‚" },
                { id: 7, stars: 49, name: "ä¼¯åˆ©æ†", theme: "è¬™å‘çš„é™ç”Ÿ", meditation: "æœ€å‰å¤§çš„ç‹ï¼Œé™ç”Ÿåœ¨æœ€å‘å¾®çš„é¦¬æ§½ã€‚é¡˜ä½ çš„å¿ƒä¹Ÿæˆç‚ºè™›å·±çš„å™¨çš¿ï¼Œè¿æ¥ä¸»çš„åŒåœ¨ã€‚" },
                { id: 8, stars: 56, name: "åŠ åˆ©åˆ©æ¹–", theme: "å¹³éœé¢¨æµª", meditation: "äººç”Ÿçš„é¢¨æµªå†å¤§ï¼Œä¸»éƒ½åœ¨èˆ¹ä¸Šã€‚é¡˜ä½ è½è¦‹é‚£è²ã€Œä½äº†å§ï¼éœäº†å§ï¼ã€ï¼Œå¾—äº«å±¬å¤©çš„å®‰æ¯ã€‚" },
                { id: 9, stars: 63, name: "å„å„ä»–", theme: "æ¨å·±çš„æ„›", meditation: "åå­—æ¶æ˜¯æ„›çš„è¨˜è™Ÿã€‚é¡˜ä½ å¸¸å¸¸æ€å¿µé‚£ç‚ºä½ æ¨å‘½çš„ä¸»ï¼Œç”Ÿå‘½å†æ¬¡è¢«æ›´æ–°ã€‚" },
                { id: 10, stars: 70, name: "æ–°è€¶è·¯æ’’å†·", theme: "æ°¸æ†çš„ç›¼æœ›", meditation: "çœ¼æ·šå¿…è¢«æ“¦å»ï¼Œä¸å†æœ‰æ­»äº¡èˆ‡æ‚²å“€ã€‚é¡˜é€™æ°¸æ†çš„å®¶é„‰ï¼Œæˆç‚ºä½ ä»Šæ—¥å¥”è·‘çš„åŠ›é‡ã€‚" }
            ]
        };

        // --- å°ˆæ¥­ç‰ˆé ­åƒçµ„ä»¶ ---
        const AvatarMale = () => (
            <div className="w-12 h-12 rounded-full overflow-hidden bg-blue-50 border-2 border-white shadow-sm shrink-0 ring-1 ring-blue-100/50">
                <svg viewBox="0 0 100 100" className="w-full h-full" preserveAspectRatio="xMidYMid slice">
                    {/* èƒŒæ™¯ */}
                    <rect width="100" height="100" fill="#EFF6FF" />
                    {/* èº«é«” */}
                    <path d="M15 100 C 15 75, 85 75, 85 100 Z" fill="#1E3A8A" />
                    {/* è„–å­ */}
                    <rect x="42" y="55" width="16" height="15" fill="#EAC0A6" />
                    {/* è‡‰éƒ¨é™°å½± */}
                    <ellipse cx="50" cy="46" rx="18" ry="21" fill="#D4A48E" /> 
                    {/* è‡‰ */}
                    <ellipse cx="50" cy="45" rx="18" ry="21" fill="#EAC0A6" />
                    {/* é ­é«®å¾Œéƒ¨ */}
                    <path d="M30 40 C 30 20, 70 20, 70 40 L 70 45 C 70 35, 60 30, 50 30 C 40 30, 32 35, 32 45 Z" fill="#2C3E50" />
                    {/* é ­é«®å‰éƒ¨ */}
                    <path d="M28 38 C 28 25, 72 25, 72 38 C 72 45, 68 35, 50 35 C 32 35, 28 45, 28 38 Z" fill="#2C3E50" />
                </svg>
            </div>
        );

        const AvatarFemale = () => (
            <div className="w-12 h-12 rounded-full overflow-hidden bg-pink-50 border-2 border-white shadow-sm shrink-0 ring-1 ring-pink-100/50">
                <svg viewBox="0 0 100 100" className="w-full h-full" preserveAspectRatio="xMidYMid slice">
                    {/* èƒŒæ™¯ */}
                    <rect width="100" height="100" fill="#FDF2F8" />
                    {/* é ­é«®å¾Œéƒ¨ */}
                    <circle cx="50" cy="48" r="24" fill="#5D4037" />
                    {/* èº«é«” */}
                    <path d="M15 100 C 15 80, 85 80, 85 100 Z" fill="#BE185D" />
                    {/* è„–å­ */}
                    <rect x="44" y="60" width="12" height="10" fill="#EAC0A6" />
                    {/* è‡‰éƒ¨é™°å½± */}
                    <ellipse cx="50" cy="51" rx="17" ry="19" fill="#D4A48E" />
                    {/* è‡‰ */}
                    <ellipse cx="50" cy="50" rx="17" ry="19" fill="#EAC0A6" />
                    {/* åŠ‰æµ· */}
                    <path d="M33 50 C 33 30, 67 30, 67 50 C 67 40, 50 38, 50 38 C 50 38, 33 40, 33 50 Z" fill="#5D4037" />
                </svg>
            </div>
        );

        // --- å…¨åŸŸè³‡æ–™è¨­å®š ---
        const TRANSLATIONS = {
            zh: {
                title: "PJBC å¹³é®æµ¸ä¿¡æœƒ",
                subtitle: "è®€ç¶“é€²åº¦",
                print_subtitle: "è®€ç¶“é€²åº¦è¡¨",
                greeting: "å¹³å®‰ï¼é¡˜ç¥çš„è©±èªæˆç‚ºä½ è…³å‰çš„ç‡ˆ",
                today_btn: "ä»Šæ—¥é€²åº¦",
                days_read: "æ˜Ÿæ˜Ÿè¨˜å¿µ",
                days_unit: "é¡†æ˜Ÿ",
                full_schedule: "å®Œæ•´é€²åº¦è¡¨",
                view_list: "æŸ¥çœ‹åˆ—è¡¨",
                view_journey: "æŸ¥çœ‹æ—…ç¨‹",
                daily_one: "æ¯æ—¥ä¸€ç« ", 
                daily_ten: "æ¯æ—¥åç« ", 
                mark_read: "æ¨™è¨˜å·²è®€",
                marked: "å·²è®€å®Œ",
                note_title: "éˆä¿®ç­†è¨˜", 
                note_placeholder: "è¨˜éŒ„ç¥ä»Šå¤©å°ä½ èªªçš„è©±...",
                source: "ä¾†æº: Bolls.life API",
                version: "å’Œåˆæœ¬ (CUV)",
                loading: "è¼‰å…¥ä¸­...",
                no_data: "ç„¡è³‡æ–™",
                print_btn: "ä¸‹è¼‰/åˆ—å°",
                print_modal_title: "åˆ—å°èˆ‡ä¸‹è¼‰è¨­å®š",
                print_desc: "è«‹é¸æ“‡å¹´ä»½èˆ‡æœˆä»½ (å¯å¤šé¸)ï¼Œç³»çµ±å°‡ç”Ÿæˆå°ˆç”¨çš„ A4 é€²åº¦è¡¨ã€‚",
                print_preview_btn: "é è¦½æ–‡ä»¶",
                print_now: "ç«‹å³åˆ—å°",
                download_png: "ä¸‹è¼‰æ‰€æœ‰åœ–ç‰‡ (PNG)",
                download_pdf: "ä¸‹è¼‰ PDF",
                close_preview: "é—œé–‰",
                cancel: "å–æ¶ˆ",
                year: "å¹´",
                month: "æœˆ",
                check_col: "å®Œæˆ",
                date_col: "æ—¥æœŸ",
                select_all: "å…¨é¸",
                deselect_all: "å–æ¶ˆå…¨é¸",
                journey_title: "æˆ‘çš„è–ç¶“æ—…ç¨‹",
                journey_subtitle: "æ¯ä¸€å€‹è…³æ­¥ï¼Œç¥éƒ½è¨˜å¿µ",
                character_unlock: "è–ç¶“äººç‰©è§£é–æ¦œ",
                location_map: "è–ç¶“åœ°åœ–",
                locked: "å°šæœªè§£é–",
                current_pos: "ç›®å‰ä½ç½®",
                star_toast: "ä½ ä»Šå¤©é¸æ“‡äº†ç¥çš„è©±ï¼Œé€™ä¸€é¡†æ˜Ÿæ˜Ÿç‚ºä½ è¨˜å¿µã€‚",
                unlock_toast: "ğŸ‰ æ­å–œï¼ä½ è§£é–äº†æ–°çš„çå‹µï¼š",
                nav: { home: "é¦–é ", calendar: "æœˆæ›†", table: "åˆ—è¡¨", journey: "æ—…ç¨‹" }
            },
            en: {
                title: "PJBC", 
                subtitle: "Bible Schedule",
                print_subtitle: "Bible Reading Schedule",
                greeting: "Peace! Your word is a lamp for my feet",
                today_btn: "Today's Plan",
                days_read: "Stars",
                days_unit: "stars",
                full_schedule: "Full Schedule",
                view_list: "View List",
                view_journey: "My Journey",
                daily_one: "Daily One",
                daily_ten: "Daily Ten",
                mark_read: "Mark Read",
                marked: "Finished",
                note_title: "Devotional Notes",
                note_placeholder: "What is God saying to you today?",
                source: "Source: Bolls.life API",
                version: "English (WEB)",
                loading: "Loading...",
                no_data: "No Data",
                print_btn: "Download/Print",
                print_modal_title: "Print & Download Settings",
                print_desc: "Select year and month(s) to generate printable A4 schedules.",
                print_preview_btn: "Preview Document",
                print_now: "Print Now",
                download_png: "Download Image",
                download_pdf: "Download PDF",
                close_preview: "Close",
                cancel: "Cancel",
                year: "",
                month: "",
                check_col: "âœ“",
                date_col: "Date",
                select_all: "Select All",
                deselect_all: "Clear",
                journey_title: "My Journey",
                journey_subtitle: "God remembers every step",
                character_unlock: "Witnesses",
                location_map: "Bible Map",
                locked: "Locked",
                current_pos: "Current",
                star_toast: "You chose God's word today. A star marks your journey.",
                unlock_toast: "ğŸ‰ Congrats! You unlocked: ",
                nav: { home: "Home", calendar: "Calendar", table: "List", journey: "Journey" }
            }
        };

        const WEEKDAY_MAP = { "æ—¥": "Sun", "ä¸€": "Mon", "äºŒ": "Tue", "ä¸‰": "Wed", "å››": "Thu", "äº”": "Fri", "å…­": "Sat" };

        const ABBREV_TO_FULL_ZH = {
            "å‰µ": "å‰µä¸–è¨˜", "å‡º": "å‡ºåŸƒåŠè¨˜", "åˆ©": "åˆ©æœªè¨˜", "æ°‘": "æ°‘æ•¸è¨˜", "ç”³": "ç”³å‘½è¨˜",
            "æ›¸": "ç´„æ›¸äºè¨˜", "å£«": "å£«å¸«è¨˜", "å¾—": "è·¯å¾—è¨˜", "æ’’ä¸Š": "æ’’æ¯è€³è¨˜ä¸Š", "æ’’ä¸‹": "æ’’æ¯è€³è¨˜ä¸‹",
            "ç‹ä¸Š": "åˆ—ç‹ç´€ä¸Š", "ç‹ä¸‹": "åˆ—ç‹ç´€ä¸‹", "ä»£ä¸Š": "æ­·ä»£å¿—ä¸Š", "ä»£ä¸‹": "æ­·ä»£å¿—ä¸‹",
            "æ‹‰": "ä»¥æ–¯æ‹‰è¨˜", "å°¼": "å°¼å¸Œç±³è¨˜", "æ–¯": "ä»¥æ–¯å¸–è¨˜", "ä¼¯": "ç´„ä¼¯è¨˜",
            "è©©": "è©©ç¯‡", "ç®´": "ç®´è¨€", "å‚³": "å‚³é“æ›¸", "æ­Œ": "é›…æ­Œ",
            "è³½": "ä»¥è³½äºæ›¸", "è€¶": "è€¶åˆ©ç±³æ›¸", "å“€": "è€¶åˆ©ç±³å“€æ­Œ", "çµ": "ä»¥è¥¿çµæ›¸", "ä½†": "ä½†ä»¥ç†æ›¸",
            "ä½•": "ä½•è¥¿é˜¿æ›¸", "ç¥": "ç´„ç¥æ›¸", "æ‘©": "é˜¿æ‘©å¸æ›¸", "ä¿„": "ä¿„å·´åº•äºæ›¸", "æ‹¿": "ç´„æ‹¿æ›¸", "å½Œ": "å½Œè¿¦æ›¸",
            "é´»": "é‚£é´»æ›¸", "å“ˆ": "å“ˆå·´è°·æ›¸", "ç•ª": "è¥¿ç•ªé›…æ›¸", "è©²": "å“ˆè©²æ›¸", "äº": "æ’’è¿¦åˆ©äºæ›¸", "ç‘ª": "ç‘ªæ‹‰åŸºæ›¸",
            "å¤ª": "é¦¬å¤ªç¦éŸ³", "å¯": "é¦¬å¯ç¦éŸ³", "è·¯": "è·¯åŠ ç¦éŸ³", "ç´„": "ç´„ç¿°ç¦éŸ³", "å¾’": "ä½¿å¾’è¡Œå‚³",
            "ç¾…": "ç¾…é¦¬æ›¸", "æ—å‰": "å“¥æ—å¤šå‰æ›¸", "æ—å¾Œ": "å“¥æ—å¤šå¾Œæ›¸", "åŠ ": "åŠ æ‹‰å¤ªæ›¸", "å¼—": "ä»¥å¼—æ‰€æ›¸",
            "è…“": "è…“ç«‹æ¯”æ›¸", "è¥¿": "æ­Œç¾…è¥¿æ›¸", "å¸–å‰": "å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸", "å¸–å¾Œ": "å¸–æ’’ç¾…å°¼è¿¦å¾Œæ›¸",
            "æå‰": "ææ‘©å¤ªå‰æ›¸", "æå¾Œ": "ææ‘©å¤ªå¾Œæ›¸", "å¤š": "æå¤šæ›¸", "é–€": "è…“åˆ©é–€æ›¸", "ä¾†": "å¸Œä¼¯ä¾†æ›¸", 
            "é›…": "é›…å„æ›¸", "å½¼å‰": "å½¼å¾—å‰æ›¸", "å½¼å¾Œ": "å½¼å¾—å¾Œæ›¸", "ç´„ä¸€": "ç´„ç¿°ä¸€æ›¸", "ç´„äºŒ": "ç´„ç¿°äºŒæ›¸", "ç´„ä¸‰": "ç´„ç¿°ä¸‰æ›¸",
            "çŒ¶": "çŒ¶å¤§æ›¸", "å•Ÿ": "å•Ÿç¤ºéŒ„"
        };
        const FULL_TO_ABBREV_ZH = Object.fromEntries(Object.entries(ABBREV_TO_FULL_ZH).map(([k, v]) => [v, k]));

        const ZH_TO_EN_ABBREV = {
            "å‰µä¸–è¨˜": "Gen", "å‰µ": "Gen", "å‡ºåŸƒåŠè¨˜": "Exod", "å‡º": "Exod", "åˆ©æœªè¨˜": "Lev", "åˆ©": "Lev", "æ°‘æ•¸è¨˜": "Num", "æ°‘": "Num", "ç”³å‘½è¨˜": "Deut", "ç”³": "Deut",
            "ç´„æ›¸äºè¨˜": "Josh", "æ›¸": "Josh", "å£«å¸«è¨˜": "Judg", "å£«": "Judg", "è·¯å¾—è¨˜": "Ruth", "å¾—": "Ruth",
            "æ’’æ¯è€³è¨˜ä¸Š": "1 Sam", "æ’’ä¸Š": "1 Sam", "æ’’æ¯è€³è¨˜ä¸‹": "2 Sam", "æ’’ä¸‹": "2 Sam",
            "åˆ—ç‹ç´€ä¸Š": "1 Kgs", "ç‹ä¸Š": "1 Kgs", "åˆ—ç‹ç´€ä¸‹": "2 Kgs", "ç‹ä¸‹": "2 Kgs",
            "æ­·ä»£å¿—ä¸Š": "1 Chr", "ä»£ä¸Š": "1 Chr", "æ­·ä»£å¿—ä¸‹": "2 Chr", "ä»£ä¸‹": "2 Chr",
            "ä»¥æ–¯æ‹‰è¨˜": "Ezra", "æ‹‰": "Ezra", "å°¼å¸Œç±³è¨˜": "Neh", "å°¼": "Neh", "ä»¥æ–¯å¸–è¨˜": "Esth", "æ–¯": "Esth",
            "ç´„ä¼¯è¨˜": "Job", "ä¼¯": "Job", "è©©ç¯‡": "Ps", "è©©": "Ps", "ç®´è¨€": "Prov", "ç®´": "Prov", "å‚³é“æ›¸": "Eccl", "å‚³": "Eccl", "é›…æ­Œ": "Song", "æ­Œ": "Song",
            "ä»¥è³½äºæ›¸": "Isa", "è³½": "Isa", "è€¶åˆ©ç±³æ›¸": "Jer", "è€¶": "Jer", "è€¶åˆ©ç±³å“€æ­Œ": "Lam", "å“€": "Lam", "ä»¥è¥¿çµæ›¸": "Ezek", "çµ": "Ezek", "ä½†ä»¥ç†æ›¸": "Dan", "ä½†": "Dan",
            "ä½•è¥¿é˜¿æ›¸": "Hos", "ä½•": "Hos", "ç´„ç¥æ›¸": "Joel", "ç¥": "Joel", "é˜¿æ‘©å¸æ›¸": "Amos", "æ‘©": "Amos", "ä¿„å·´åº•äºæ›¸": "Obad", "ä¿„": "Obad", "ç´„æ‹¿æ›¸": "Jonah", "æ‹¿": "Jonah", "å½Œè¿¦æ›¸": "Mic", "å½Œ": "Mic",
            "é‚£é´»æ›¸": "Nah", "é´»": "Nah", "å“ˆå·´è°·æ›¸": "Hab", "å“ˆ": "Hab", "è¥¿ç•ªé›…æ›¸": "Zeph", "ç•ª": "Zeph", "å“ˆè©²æ›¸": "Hag", "è©²": "Hag", "æ’’è¿¦åˆ©äºæ›¸": "Zech", "äº": "Zech", "ç‘ªæ‹‰åŸºæ›¸": "Mal", "ç‘ª": "Mal",
            "é¦¬å¤ªç¦éŸ³": "Matt", "å¤ª": "Matt", "é¦¬å¯ç¦éŸ³": "Mark", "å¯": "Mark", "è·¯åŠ ç¦éŸ³": "Luke", "è·¯": "Luke", "ç´„ç¿°ç¦éŸ³": "John", "ç´„": "John", "ä½¿å¾’è¡Œå‚³": "Acts", "å¾’": "Acts",
            "ç¾…é¦¬æ›¸": "Rom", "ç¾…": "Rom", "å“¥æ—å¤šå‰æ›¸": "1 Cor", "æ—å‰": "1 Cor", "å“¥æ—å¤šå¾Œæ›¸": "2 Cor", "æ—å¾Œ": "2 Cor", "åŠ æ‹‰å¤ªæ›¸": "Gal", "åŠ ": "Gal",
            "ä»¥å¼—æ‰€æ›¸": "Eph", "å¼—": "Eph", "è…“ç«‹æ¯”æ›¸": "Phil", "è…“": "Phil", "æ­Œç¾…è¥¿æ›¸": "Col", "è¥¿": "Col",
            "å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸": "1 Thess", "å¸–å‰": "1 Thess", "å¸–æ’’ç¾…å°¼è¿¦å¾Œæ›¸": "2 Thess", "å¸–å¾Œ": "2 Thess",
            "ææ‘©å¤ªå‰æ›¸": "1 Tim", "æå‰": "1 Tim", "ææ‘©å¤ªå¾Œæ›¸": "2 Tim", "æå¾Œ": "2 Tim", "æå¤šæ›¸": "Titus", "å¤š": "Titus", "è…“åˆ©é–€æ›¸": "Phlm", "é–€": "Phlm",
            "å¸Œä¼¯ä¾†æ›¸": "Heb", "ä¾†": "Heb", 
            "é›…å„æ›¸": "Jas", "é›…": "Jas", "å½¼å¾—å‰æ›¸": "1 Pet", "å½¼å‰": "1 Pet", "å½¼å¾—å¾Œæ›¸": "2 Pet", "å½¼å¾Œ": "2 Pet",
            "ç´„ç¿°ä¸€æ›¸": "1 John", "ç´„ä¸€": "1 John", "ç´„ç¿°äºŒæ›¸": "2 John", "ç´„äºŒ": "2 John", "ç´„ç¿°ä¸‰æ›¸": "3 John", "ç´„ä¸‰": "3 John",
            "çŒ¶å¤§æ›¸": "Jude", "çŒ¶": "Jude", "å•Ÿç¤ºéŒ„": "Rev", "å•Ÿ": "Rev"
        };

        const BIBLE_BOOKS_ID = {
          "å‰µä¸–è¨˜": 1, "å‰µ": 1, "å‡ºåŸƒåŠè¨˜": 2, "å‡º": 2, "åˆ©æœªè¨˜": 3, "åˆ©": 3, "æ°‘æ•¸è¨˜": 4, "æ°‘": 4, "ç”³å‘½è¨˜": 5, "ç”³": 5,
          "ç´„æ›¸äºè¨˜": 6, "æ›¸": 6, "å£«å¸«è¨˜": 7, "å£«": 7, "è·¯å¾—è¨˜": 8, "å¾—": 8, "æ’’æ¯è€³è¨˜ä¸Š": 9, "æ’’ä¸Š": 9, "æ’’æ¯è€³è¨˜ä¸‹": 10, "æ’’ä¸‹": 10,
          "åˆ—ç‹ç´€ä¸Š": 11, "ç‹ä¸Š": 11, "åˆ—ç‹ç´€ä¸‹": 12, "ç‹ä¸‹": 12, "æ­·ä»£å¿—ä¸Š": 13, "ä»£ä¸Š": 13, "æ­·ä»£å¿—ä¸‹": 14, "ä»£ä¸‹": 14,
          "ä»¥æ–¯æ‹‰è¨˜": 15, "æ‹‰": 15, "å°¼å¸Œç±³è¨˜": 16, "å°¼": 16, "ä»¥æ–¯å¸–è¨˜": 17, "æ–¯": 17, "ç´„ä¼¯è¨˜": 18, "ä¼¯": 18,
          "è©©ç¯‡": 19, "è©©": 19, "ç®´è¨€": 20, "ç®´": 20, "å‚³é“æ›¸": 21, "å‚³": 21, "é›…æ­Œ": 22, "æ­Œ": 22,
          "ä»¥è³½äºæ›¸": 23, "è³½": 23, "è€¶åˆ©ç±³æ›¸": 24, "è€¶": 24, "è€¶åˆ©ç±³å“€æ­Œ": 25, "å“€": 25, "ä»¥è¥¿çµæ›¸": 26, "çµ": 26,
          "ä½†ä»¥ç†æ›¸": 27, "ä½†": 27, "ä½•è¥¿é˜¿æ›¸": 28, "ä½•": 28, "ç´„ç¥æ›¸": 29, "ç¥": 29, "é˜¿æ‘©å¸æ›¸": 30, "æ‘©": 30,
          "ä¿„å·´åº•äºæ›¸": 31, "ä¿„": 31, "ç´„æ‹¿æ›¸": 32, "æ‹¿": 32, "å½Œè¿¦æ›¸": 33, "å½Œ": 33, "é‚£é´»æ›¸": 34, "é´»": 34,
          "å“ˆå·´è°·æ›¸": 35, "å“ˆ": 35, "è¥¿ç•ªé›…æ›¸": 36, "ç•ª": 36, "å“ˆè©²æ›¸": 37, "è©²": 37, "æ’’è¿¦åˆ©äºæ›¸": 38, "äº": 38, "ç‘ªæ‹‰åŸºæ›¸": 39, "ç‘ª": 39,
          "é¦¬å¤ªç¦éŸ³": 40, "å¤ª": 40, "é¦¬å¯ç¦éŸ³": 41, "å¯": 41, "è·¯åŠ ç¦éŸ³": 42, "è·¯": 42, "ç´„ç¿°ç¦éŸ³": 43, "ç´„": 43, "ä½¿å¾’è¡Œå‚³": 44, "å¾’": 44,
          "ç¾…é¦¬æ›¸": 45, "ç¾…": 45, "å“¥æ—å¤šå‰æ›¸": 46, "æ—å‰": 46, "å“¥æ—å¤šå¾Œæ›¸": 47, "æ—å¾Œ": 47, "åŠ æ‹‰å¤ªæ›¸": 48, "åŠ ": 48,
          "ä»¥å¼—æ‰€æ›¸": 49, "å¼—": 49, "è…“ç«‹æ¯”æ›¸": 50, "è…“": 50, "æ­Œç¾…è¥¿æ›¸": 51, "è¥¿": 51, "å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸": 52, "å¸–å‰": 52, "å¸–æ’’ç¾…å°¼è¿¦å¾Œæ›¸": 53, "å¸–å¾Œ": 53,
          "ææ‘©å¤ªå‰æ›¸": 54, "æå‰": 54, "ææ‘©å¤ªå¾Œæ›¸": 55, "æå¾Œ": 55, "æå¤šæ›¸": 56, "å¤š": 56, "è…“åˆ©é–€æ›¸": 57, "é–€": 57,
          "å¸Œä¼¯ä¾†æ›¸": 58, "ä¾†": 58, 
          "é›…å„æ›¸": 59, "é›…": 59, "å½¼å¾—å‰æ›¸": 60, "å½¼å‰": 60, "å½¼å¾—å¾Œæ›¸": 61, "å½¼å¾Œ": 61,
          "ç´„ç¿°ä¸€æ›¸": 62, "ç´„ä¸€": 62, "ç´„ç¿°äºŒæ›¸": 63, "ç´„äºŒ": 63, "ç´„ç¿°ä¸‰æ›¸": 64, "ç´„ä¸‰": 64, "çŒ¶å¤§æ›¸": 65, "çŒ¶": 65, "å•Ÿç¤ºéŒ„": 66, "å•Ÿ": 66
        };

        const ZH_TO_EN_BOOKS = {
             "å‰µä¸–è¨˜": "Genesis", "å‰µ": "Genesis", "å‡ºåŸƒåŠè¨˜": "Exodus", "å‡º": "Exodus", "åˆ©æœªè¨˜": "Leviticus", "åˆ©": "Leviticus", "æ°‘æ•¸è¨˜": "Numbers", "æ°‘": "Numbers", "ç”³å‘½è¨˜": "Deuteronomy", "ç”³": "Deuteronomy",
            "ç´„æ›¸äºè¨˜": "Joshua", "æ›¸": "Joshua", "å£«å¸«è¨˜": "Judges", "å£«": "Judges", "è·¯å¾—è¨˜": "Ruth", "å¾—": "Ruth", "æ’’æ¯è€³è¨˜ä¸Š": "1 Samuel", "æ’’ä¸Š": "1 Samuel", "æ’’æ¯è€³è¨˜ä¸‹": "2 Samuel", "æ’’ä¸‹": "2 Samuel",
            "åˆ—ç‹ç´€ä¸Š": "1 Kings", "ç‹ä¸Š": "1 Kings", "åˆ—ç‹ç´€ä¸‹": "2 Kings", "ç‹ä¸‹": "2 Kings", "æ­·ä»£å¿—ä¸Š": "1 Chronicles", "ä»£ä¸Š": "1 Chronicles", "æ­·ä»£å¿—ä¸‹": "2 Chronicles", "ä»£ä¸‹": "2 Chronicles",
            "ä»¥æ–¯æ‹‰è¨˜": "Ezra", "æ‹‰": "Ezra", "å°¼å¸Œç±³è¨˜": "Nehemiah", "å°¼": "Nehemiah", "ä»¥æ–¯å¸–è¨˜": "Esther", "æ–¯": "Esther", "ç´„ä¼¯è¨˜": "Job", "ä¼¯": "Job",
            "è©©ç¯‡": "Psalms", "è©©": "Psalms", "ç®´è¨€": "Proverbs", "ç®´": "Proverbs", "å‚³é“æ›¸": "Ecclesiastes", "å‚³": "Ecclesiastes", "é›…æ­Œ": "Song of Songs", "æ­Œ": "Song of Songs",
            "ä»¥è³½äºæ›¸": "Isaiah", "è³½": "Isaiah", "è€¶åˆ©ç±³æ›¸": "Jeremiah", "è€¶": "Jeremiah", "è€¶åˆ©ç±³å“€æ­Œ": "Lamentations", "å“€": "Lamentations", "ä»¥è¥¿çµæ›¸": "Ezekiel", "çµ": "Ezekiel", "ä½†ä»¥ç†æ›¸": "Daniel", "ä½†": "Daniel",
            "ä½•è¥¿é˜¿æ›¸": "Hosea", "ä½•": "Hosea", "ç´„ç¥æ›¸": "Joel", "ç¥": "Joel", "é˜¿æ‘©å¸æ›¸": "Amos", "æ‘©": "Amos", "ä¿„å·´åº•äºæ›¸": "Obadiah", "ä¿„": "Obadiah", "ç´„æ‹¿æ›¸": "Jonah", "æ‹¿": "Jonah", "å½Œè¿¦æ›¸": "Micah", "å½Œ": "Micah",
            "é‚£é´»æ›¸": "Nahum", "é´»": "Nahum", "å“ˆå·´è°·æ›¸": "Habakkuk", "å“ˆ": "Habakkuk", "è¥¿ç•ªé›…æ›¸": "Zephaniah", "ç•ª": "Zephaniah", "å“ˆè©²æ›¸": "Haggai", "è©²": "Haggai", "æ’’è¿¦åˆ©äºæ›¸": "Zechariah", "äº": "Zechariah", "ç‘ªæ‹‰åŸºæ›¸": "Malachi", "ç‘ª": "Malachi",
            "é¦¬å¤ªç¦éŸ³": "Matthew", "å¤ª": "Matthew", "é¦¬å¯ç¦éŸ³": "Mark", "å¯": "Mark", "è·¯åŠ ç¦éŸ³": "Luke", "è·¯": "Luke", "ç´„ç¿°ç¦éŸ³": "John", "ç´„": "John", "ä½¿å¾’è¡Œå‚³": "Acts", "å¾’": "Acts",
            "ç¾…é¦¬æ›¸": "Romans", "ç¾…": "Romans", "å“¥æ—å¤šå‰æ›¸": "1 Corinthians", "æ—å‰": "1 Corinthians", "å“¥æ—å¤šå¾Œæ›¸": "2 Corinthians", "æ—å¾Œ": "2 Corinthians", "åŠ æ‹‰å¤ªæ›¸": "Galatians", "åŠ ": "Galatians", "ä»¥å¼—æ‰€æ›¸": "Ephesians", "å¼—": "Ephesians",
            "è…“ç«‹æ¯”æ›¸": "Philippians", "è…“": "Philippians", "æ­Œç¾…è¥¿æ›¸": "Colossians", "è¥¿": "Colossians", "å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸": "1 Thessalonians", "å¸–å‰": "1 Thessalonians", "å¸–æ’’ç¾…å°¼è¿¦å¾Œæ›¸": "2 Thessalonians", "å¸–å¾Œ": "2 Thessalonians",
            "ææ‘©å¤ªå‰æ›¸": "1 Timothy", "æå‰": "1 Timothy", "ææ‘©å¤ªå¾Œæ›¸": "2 Timothy", "æå¾Œ": "2 Timothy", "æå¤šæ›¸": "Titus", "å¤š": "Titus", "è…“åˆ©é–€æ›¸": "Philemon", "é–€": "Philemon", "å¸Œä¼¯ä¾†æ›¸": "Hebrews", "ä¾†": "Hebrews", 
            "é›…å„æ›¸": "James", "é›…": "James", "å½¼å¾—å‰æ›¸": "1 Peter", "å½¼å‰": "1 Peter", "å½¼å¾—å¾Œæ›¸": "2 Peter", "å½¼å¾Œ": "2 Peter", "ç´„ç¿°ä¸€æ›¸": "1 John", "ç´„ä¸€": "1 John", "ç´„ç¿°äºŒæ›¸": "2 John", "ç´„äºŒ": "2 John", "ç´„ç¿°ä¸‰æ›¸": "3 John", "ç´„ä¸‰": "3 John",
            "çŒ¶å¤§æ›¸": "Jude", "çŒ¶": "Jude", "å•Ÿç¤ºéŒ„": "Revelation", "å•Ÿ": "Revelation"
        };

        const parseScriptureString = (text) => {
            if (!text) return [];
            const segments = text.split(/[;ï¼›]/).map(s => s.trim()).filter(s => s);
            const results = [];
            segments.forEach(seg => {
                let cleanSeg = seg.replace(/\(.*?\)/g, '').replace(/ï¼ˆ.*?ï¼‰/g, '').replace(/ç« /g, '').replace(/ç¬¬/g, '').trim();
                const sortedKeys = Object.keys(BIBLE_BOOKS_ID).sort((a, b) => b.length - a.length);
                let matchedBook = "";
                let bookId = 0;
                let rangesStr = "";

                for (const key of sortedKeys) {
                    if (cleanSeg.startsWith(key)) {
                        matchedBook = key;
                        bookId = BIBLE_BOOKS_ID[key];
                        rangesStr = cleanSeg.substring(key.length).trim();
                        break;
                    }
                }
                if (bookId) {
                    if (rangesStr) {
                        const parts = rangesStr.split(/[,ï¼Œ]/);
                        parts.forEach(part => {
                            if (part.includes('-')) {
                                const [start, end] = part.split('-').map(n => parseInt(n));
                                if (!isNaN(start) && !isNaN(end)) {
                                    for (let i = start; i <= end; i++) results.push({ zhBook: matchedBook, bookId, chapter: i });
                                }
                            } else {
                                const num = parseInt(part);
                                if (!isNaN(num)) results.push({ zhBook: matchedBook, bookId, chapter: num });
                            }
                        });
                    } else if (["ä¿„å·´åº•äºæ›¸","ä¿„","è…“åˆ©é–€æ›¸","é–€","ç´„ç¿°äºŒæ›¸","ç´„äºŒ","ç´„ç¿°ä¸‰æ›¸","ç´„ä¸‰","çŒ¶å¤§æ›¸","çŒ¶"].includes(matchedBook)) {
                        results.push({ zhBook: matchedBook, bookId, chapter: 1 });
                    }
                }
            });
            return results;
        };

        const formatScriptureDisplay = (text, lang) => {
            if (!text) return "";
            let display = text.replace(/\s*[ï¼ˆ(]æ–°å¾ªç’°[)ï¼‰]/g, '')
                              .replace(/æ–°å¾ªç’°/g, '')
                              .replace(/\s*[ï¼ˆ(]ç¬¬ä¸€éè®€å®Œ[)ï¼‰]/g, '')
                              .replace(/\s*[ï¼ˆ(]èˆŠç´„ä¸€éçµ‚[)ï¼‰]/g, '')
                              .replace(/\s*[ï¼ˆ(]ç¬¬ä¸‰éè®€å®Œ[)ï¼‰]/g, '')
                              .replace(/\s*[ï¼ˆ(]ç¬¬äºŒéè®€å®Œ[)ï¼‰]/g, '')
                              .replace(/\s*[ï¼ˆ(]å·çµ‚[)ï¼‰]/g, '')
                              .replace(/å·çµ‚/g, '');

            if (lang === 'zh') {
                const sortedAbbrevs = Object.keys(ABBREV_TO_FULL_ZH).sort((a, b) => b.length - a.length);
                sortedAbbrevs.forEach(abbrev => {
                    const full = ABBREV_TO_FULL_ZH[abbrev];
                    const regex = new RegExp(`(^|[^\\u4e00-\\u9fa5])${abbrev}(?![\\u4e00-\\u9fa5])`, 'g');
                    if (abbrev === 'å‚³') {
                        display = display.replace(/(^|[^è¡Œ\u4e00-\u9fa5])å‚³(?![^\d\s\uff0c\u3001;])/g, `$1${full}`);
                    } else {
                        display = display.replace(regex, `$1${full}`);
                    }
                });
                display = display.replace(/([\u4e00-\u9fa5])\s+(\d)/g, '$1$2');
                display = display.replace(/([\u4e00-\u9fa5]+)(ç¬¬?)(\d+[-0-9,ï¼Œ]*)(ç« ?)/g, (match, book, prefix, num, suffix) => {
                    return `${book} ${num}`; 
                });
                display = display.replace(/;/g, 'ï¼›');
            } else {
                const sortedKeys = Object.keys(ZH_TO_EN_BOOKS).sort((a,b) => b.length - a.length);
                sortedKeys.forEach(zh => {
                    if (display.includes(zh)) {
                        display = display.split(zh).join(ZH_TO_EN_BOOKS[zh] + " ");
                    }
                });
                display = display.replace(/ç¬¬/g, "").replace(/ç« /g, "").replace(/ï¼›/g, "; ");
                display = display.replace(/\s+/g, ' ').trim();
            }
            return display.trim();
        };
        
        const formatCalendarDisplay = (text, lang) => {
            if (!text) return "";
            let simplified = text.replace(/\(.*?\)|\ï¼ˆ.*?\ï¼‰|æ–°å¾ªç’°|å·çµ‚/g, '');

            if (lang === 'en') {
                const sortedKeys = Object.keys(ZH_TO_EN_ABBREV).sort((a,b) => b.length - a.length);
                sortedKeys.forEach(zh => {
                    const regex = new RegExp(zh, 'g');
                    simplified = simplified.replace(regex, ZH_TO_EN_ABBREV[zh] + " ");
                });
                simplified = simplified.replace(/ç¬¬/g, "").replace(/ç« /g, "").replace(/ï¼›/g, "; ");
                simplified = simplified.replace(/\s+/g, ' ').trim();
                simplified = simplified.replace(/\s*,\s*/g, ', ');
                return simplified;
            }

            const sortedFullNames = Object.keys(FULL_TO_ABBREV_ZH).sort((a, b) => b.length - a.length);
            sortedFullNames.forEach(fullName => {
                if (simplified.includes(fullName)) {
                    simplified = simplified.replace(new RegExp(fullName, 'g'), FULL_TO_ABBREV_ZH[fullName]);
                }
            });
            simplified = simplified.replace(/\s+/g, '').replace(/ç¬¬/g, '').replace(/ç« /g, '').replace(/ï¼›/g, ' ').replace(/ï¼Œ/g, ',');
            return simplified;
        };

        const getButtonLabel = (item, lang) => {
            if (lang === 'zh') {
                const fullName = ABBREV_TO_FULL_ZH[item.zhBook] || item.zhBook;
                return `${fullName} ${item.chapter}`;
            } else {
                let enBook = ZH_TO_EN_BOOKS[item.zhBook] || "Book";
                return `${enBook} ${item.chapter}`;
            }
        };

        // ... data ...
        const generateInitialData = () => {
             const plans = [];
            const addDay = (date, wd, one, ten) => plans.push({ date, weekday: wd, dailyOne: one, dailyTen: ten });
            
            // 2025-12
            const year2025_Dec = [
                ["2025-12-01", "ä¸€", "ä½¿å¾’è¡Œå‚³ 1", "ç´„ 18-21ï¼›å¾’ 1-6"],
                ["2025-12-02", "äºŒ", "ä»¥è¥¿çµæ›¸ 29", "å¾’ 7-16"],
                ["2025-12-03", "ä¸‰", "ä»¥è¥¿çµæ›¸ 30", "å¾’ 17-26"],
                ["2025-12-04", "å››", "ä»¥è¥¿çµæ›¸ 31", "å¾’ 27-28ï¼›ç¾… 1-8"],
                ["2025-12-05", "äº”", "ä»¥è¥¿çµæ›¸ 32", "ç¾… 9-16ï¼›æ—å‰ 1-2"],
                ["2025-12-06", "å…­", "ä½¿å¾’è¡Œå‚³ 2", "æ—å‰ 3-12"],
                ["2025-12-07", "æ—¥", "ä½¿å¾’è¡Œå‚³ 3", "æ—å‰ 13-16ï¼›æ—å¾Œ 1-6"],
                ["2025-12-08", "ä¸€", "ä½¿å¾’è¡Œå‚³ 4", "æ—å¾Œ 7-13ï¼›åŠ  1-3"],
                ["2025-12-09", "äºŒ", "ä»¥è¥¿çµæ›¸ 33", "åŠ  4-6ï¼›å¼— 1-6ï¼›è…“ 1"],
                ["2025-12-10", "ä¸‰", "ä»¥è¥¿çµæ›¸ 34", "è…“ 2-4ï¼›æ­Œ 1-4ï¼›å¸–å‰ 1-3"],
                ["2025-12-11", "å››", "ä»¥è¥¿çµæ›¸ 35", "å¸–å‰ 4-5ï¼›å¸–å¾Œ 1-3ï¼›æå‰ 1-5"],
                ["2025-12-12", "äº”", "ä»¥è¥¿çµæ›¸ 36", "æå‰ 6ï¼›æå¾Œ 1-4ï¼›å¤š 1-3ï¼›é–€ 1ï¼›ä¾† 1"], // å¸Œ -> ä¾†
                ["2025-12-13", "å…­", "ä½¿å¾’è¡Œå‚³ 5", "ä¾† 2-11"], // å¸Œ -> ä¾†
                ["2025-12-14", "æ—¥", "ä½¿å¾’è¡Œå‚³ 6", "ä¾† 12-13ï¼›é›… 1-5ï¼›å½¼å‰ 1-3"], // å¸Œ -> ä¾†
                ["2025-12-15", "ä¸€", "ä½¿å¾’è¡Œå‚³ 7", "å½¼å‰ 4-5ï¼›å½¼å¾Œ 1-3ï¼›ç´„ä¸€ 1-5"],
                ["2025-12-16", "äºŒ", "ä»¥è¥¿çµæ›¸ 37", "ç´„äºŒï¼›ç´„ä¸‰ï¼›çŒ¶ï¼›å•Ÿ 1-7"],
                ["2025-12-17", "ä¸‰", "ä»¥è¥¿çµæ›¸ 38", "å•Ÿ 8-17"],
                ["2025-12-18", "å››", "ä»¥è¥¿çµæ›¸ 39", "å•Ÿ 18-22ï¼›å‰µ 1-5 (æ–°å¾ªç’°)"],
                ["2025-12-19", "äº”", "ä»¥è¥¿çµæ›¸ 40", "å‰µ 6-15"],
                ["2025-12-20", "å…­", "ä½¿å¾’è¡Œå‚³ 8", "å‰µ 16-25"],
                ["2025-12-21", "æ—¥", "ä½¿å¾’è¡Œå‚³ 9", "å‰µ 26-35"],
                ["2025-12-22", "ä¸€", "ä½¿å¾’è¡Œå‚³ 10", "å‰µ 36-45"],
                ["2025-12-23", "äºŒ", "ä»¥è¥¿çµæ›¸ 41", "å‰µ 46-50ï¼›å‡º 1-5"],
                ["2025-12-24", "ä¸‰", "ä»¥è¥¿çµæ›¸ 42", "å‡º 6-15"],
                ["2025-12-25", "å››", "ä»¥è¥¿çµæ›¸ 43", "å‡º 16-25"],
                ["2025-12-26", "äº”", "ä»¥è¥¿çµæ›¸ 44", "å‡º 26-35"],
                ["2025-12-27", "å…­", "ä½¿å¾’è¡Œå‚³ 11", "å‡º 36-40ï¼›åˆ© 1-5"],
                ["2025-12-28", "æ—¥", "ä½¿å¾’è¡Œå‚³ 12", "åˆ© 6-15"],
                ["2025-12-29", "ä¸€", "ä½¿å¾’è¡Œå‚³ 13", "åˆ© 16-25"],
                ["2025-12-30", "äºŒ", "ä»¥è¥¿çµæ›¸ 45", "åˆ© 26-27ï¼›æ°‘ 1-8"],
                ["2025-12-31", "ä¸‰", "ä»¥è¥¿çµæ›¸ 46", "æ°‘ 9-18"]
            ];
            // 2026 Full
            const year2026 = [
                ["2026-01-01", "å››", "çµ 47", "æ°‘ 19-28"],
                ["2026-01-02", "äº”", "çµ 48 (å·çµ‚)", "æ°‘ 29-36ï¼›ç”³ 1-2"],
                ["2026-01-03", "å…­", "å¾’ 14", "ç”³ 3-12"],
                ["2026-01-04", "æ—¥", "å¾’ 15", "ç”³ 13-22"],
                ["2026-01-05", "ä¸€", "å¾’ 16", "ç”³ 23-32"],
                ["2026-01-06", "äºŒ", "ä½† 1", "ç”³ 33-34ï¼›æ›¸ 1-8"],
                ["2026-01-07", "ä¸‰", "ä½† 2", "æ›¸ 9-18"],
                ["2026-01-08", "å››", "ä½† 3", "æ›¸ 19-24ï¼›å£« 1-4"],
                ["2026-01-09", "äº”", "ä½† 4", "å£« 5-14"],
                ["2026-01-10", "å…­", "å¾’ 17", "å£« 15-21ï¼›å¾— 1-3"],
                ["2026-01-11", "æ—¥", "å¾’ 18", "å¾— 4ï¼›æ’’ä¸Š 1-9"],
                ["2026-01-12", "ä¸€", "å¾’ 19", "æ’’ä¸Š 10-19"],
                ["2026-01-13", "äºŒ", "ä½† 5", "æ’’ä¸Š 20-29"],
                ["2026-01-14", "ä¸‰", "ä½† 6", "æ’’ä¸Š 30-31ï¼›æ’’ä¸‹ 1-8"],
                ["2026-01-15", "å››", "ä½† 7", "æ’’ä¸‹ 9-18"],
                ["2026-01-16", "äº”", "ä½† 8", "æ’’ä¸‹ 19-24ï¼›ç‹ä¸Š 1-4"],
                ["2026-01-17", "å…­", "å¾’ 20", "ç‹ä¸Š 5-14"],
                ["2026-01-18", "æ—¥", "å¾’ 21", "ç‹ä¸Š 15-22ï¼›ç‹ä¸‹ 1-2"],
                ["2026-01-19", "ä¸€", "å¾’ 22", "ç‹ä¸‹ 3-12"],
                ["2026-01-20", "äºŒ", "ä½† 9", "ç‹ä¸‹ 13-22"],
                ["2026-01-21", "ä¸‰", "ä½† 10", "ç‹ä¸‹ 23-25ï¼›ä»£ä¸Š 1-7"],
                ["2026-01-22", "å››", "ä½† 11", "ä»£ä¸Š 8-17"],
                ["2026-01-23", "äº”", "ä½† 12 (å·çµ‚)", "ä»£ä¸Š 18-27"],
                ["2026-01-24", "å…­", "å¾’ 23", "ä»£ä¸Š 28-29ï¼›ä»£ä¸‹ 1-8"],
                ["2026-01-25", "æ—¥", "å¾’ 24", "ä»£ä¸‹ 9-18"],
                ["2026-01-26", "ä¸€", "å¾’ 25", "ä»£ä¸‹ 19-28"],
                ["2026-01-27", "äºŒ", "ä½• 1", "ä»£ä¸‹ 29-36ï¼›æ‹‰ 1-2"],
                ["2026-01-28", "ä¸‰", "ä½• 2", "æ‹‰ 3-10ï¼›å°¼ 1-2"],
                ["2026-01-29", "å››", "ä½• 3", "å°¼ 3-12"],
                ["2026-01-30", "äº”", "ä½• 4", "å°¼ 13ï¼›æ–¯ 1-9"],
                ["2026-01-31", "å…­", "å¾’ 26", "æ–¯ 10ï¼›ä¼¯ 1-9"],
                ["2026-02-01", "æ—¥", "å¾’ 27", "ä¼¯ 10-19"],
                ["2026-02-02", "ä¸€", "å¾’ 28 (å·çµ‚)", "ä¼¯ 20-29"],
                ["2026-02-03", "äºŒ", "ä½• 5", "ä¼¯ 30-39"],
                ["2026-02-04", "ä¸‰", "ä½• 6", "ä¼¯ 40-42ï¼›è©© 1-7"],
                ["2026-02-05", "å››", "ä½• 7", "è©© 8-17"],
                ["2026-02-06", "äº”", "ä½• 8", "è©© 18-27"],
                ["2026-02-07", "å…­", "ç¾… 1", "è©© 28-37"],
                ["2026-02-08", "æ—¥", "ç¾… 2", "è©© 38-47"],
                ["2026-02-09", "ä¸€", "ç¾… 3", "è©© 48-57"],
                ["2026-02-10", "äºŒ", "ä½• 9", "è©© 58-67"],
                ["2026-02-11", "ä¸‰", "ä½• 10", "è©© 68-77"],
                ["2026-02-12", "å››", "ä½• 11", "è©© 78-87"],
                ["2026-02-13", "äº”", "ä½• 12", "è©© 88-97"],
                ["2026-02-14", "å…­", "ç¾… 4", "è©© 98-107"],
                ["2026-02-15", "æ—¥", "ç¾… 5", "è©© 108-117"],
                ["2026-02-16", "ä¸€", "ç¾… 6", "è©© 118-127"],
                ["2026-02-17", "äºŒ", "ä½• 13", "è©© 128-137"],
                ["2026-02-18", "ä¸‰", "ä½• 14 (å·çµ‚)", "è©© 138-147"],
                ["2026-02-19", "å››", "ç¥ 1", "è©© 148-150ï¼›ç®´ 1-7"],
                ["2026-02-20", "äº”", "ç¥ 2", "ç®´ 8-17"],
                ["2026-02-21", "å…­", "ç¾… 7", "ç®´ 18-27"],
                ["2026-02-22", "æ—¥", "ç¾… 8", "ç®´ 28-31ï¼›å‚³ 1-6"],
                ["2026-02-23", "ä¸€", "ç¾… 9", "å‚³ 7-12ï¼›æ­Œ 1-4"],
                ["2026-02-24", "äºŒ", "ç¥ 3 (å·çµ‚)", "æ­Œ 5-8ï¼›è³½ 1-6"],
                ["2026-02-25", "ä¸‰", "æ‘© 1", "è³½ 7-16"],
                ["2026-02-26", "å››", "æ‘© 2", "è³½ 17-26"],
                ["2026-02-27", "äº”", "æ‘© 3", "è³½ 27-36"],
                ["2026-02-28", "å…­", "ç¾… 10", "è³½ 37-46"],
                ["2026-03-01", "æ—¥", "ç¾… 11", "è³½ 47-56"],
                ["2026-03-02", "ä¸€", "ç¾… 12", "è³½ 57-66"],
                ["2026-03-03", "äºŒ", "æ‘© 4", "è€¶ 1-10"],
                ["2026-03-04", "ä¸‰", "æ‘© 5", "è€¶ 11-20"],
                ["2026-03-05", "å››", "æ‘© 6", "è€¶ 21-30"],
                ["2026-03-06", "äº”", "æ‘© 7", "è€¶ 31-40"],
                ["2026-03-07", "å…­", "ç¾… 13", "è€¶ 41-50"],
                ["2026-03-08", "æ—¥", "ç¾… 14", "è€¶ 51-52ï¼›å“€ 1-5ï¼›çµ 1-3"],
                ["2026-03-09", "ä¸€", "ç¾… 15", "çµ 4-13"],
                ["2026-03-10", "äºŒ", "æ‘© 8", "çµ 14-23"],
                ["2026-03-11", "ä¸‰", "æ‘© 9 (å·çµ‚)", "çµ 24-33"],
                ["2026-03-12", "å››", "ä¿„", "çµ 34-43"],
                ["2026-03-13", "äº”", "æ‹¿ 1", "çµ 44-48ï¼›ä½† 1-5"],
                ["2026-03-14", "å…­", "ç¾… 16 (å·çµ‚)", "ä½† 6-12ï¼›ä½• 1-3"],
                ["2026-03-15", "æ—¥", "æ—å‰ 1", "ä½• 4-13"],
                ["2026-03-16", "ä¸€", "æ—å‰ 2", "ä½• 14ï¼›ç¥ 1-3ï¼›æ‘© 1-6"],
                ["2026-03-17", "äºŒ", "æ‹¿ 2", "æ‘© 7-9ï¼›ä¿„ï¼›æ‹¿ 1-4ï¼›å½Œ 1-2"],
                ["2026-03-18", "ä¸‰", "æ‹¿ 3", "å½Œ 3-7ï¼›é´» 1-3ï¼›å“ˆ 1-2"],
                ["2026-03-19", "å››", "æ‹¿ 4 (å·çµ‚)", "å“ˆ 3ï¼›ç•ª 1-3ï¼›è©² 1-2ï¼›äº 1-4"],
                ["2026-03-20", "äº”", "å½Œ 1", "äº 5-14"],
                ["2026-03-21", "å…­", "æ—å‰ 3", "ç‘ª 1-4ï¼›å¤ª 1-6"],
                ["2026-03-22", "æ—¥", "æ—å‰ 4", "å¤ª 7-16"],
                ["2026-03-23", "ä¸€", "æ—å‰ 5", "å¤ª 17-26"],
                ["2026-03-24", "äºŒ", "å½Œ 2", "å¤ª 27-28ï¼›å¯ 1-8"],
                ["2026-03-25", "ä¸‰", "å½Œ 3", "å¯ 9-16ï¼›è·¯ 1-2"],
                ["2026-03-26", "å››", "å½Œ 4", "è·¯ 3-12"],
                ["2026-03-27", "äº”", "å½Œ 5", "è·¯ 13-22"],
                ["2026-03-28", "å…­", "æ—å‰ 6", "è·¯ 23-24ï¼›ç´„ 1-8"],
                ["2026-03-29", "æ—¥", "æ—å‰ 7", "ç´„ 9-18"],
                ["2026-03-30", "ä¸€", "æ—å‰ 8", "ç´„ 19-21ï¼›å¾’ 1-7"],
                ["2026-03-31", "äºŒ", "å½Œ 6", "å¾’ 8-17"],
                ["2026-04-01", "ä¸‰", "å½Œ 7 (å·çµ‚)", "å¾’ 18-27"],
                ["2026-04-02", "å››", "é´» 1", "å¾’ 28ï¼›ç¾… 1-9"],
                ["2026-04-03", "äº”", "é´» 2", "ç¾… 10-16ï¼›æ—å‰ 1-3"],
                ["2026-04-04", "å…­", "æ—å‰ 9", "æ—å‰ 4-13"],
                ["2026-04-05", "æ—¥", "æ—å‰ 10", "æ—å‰ 14-16ï¼›æ—å¾Œ 1-7"],
                ["2026-04-06", "ä¸€", "æ—å‰ 11", "æ—å¾Œ 8-13ï¼›åŠ  1-4"],
                ["2026-04-07", "äºŒ", "é´» 3 (å·çµ‚)", "åŠ  5-6ï¼›å¼— 1-6ï¼›è…“ 1-2"],
                ["2026-04-08", "ä¸‰", "å“ˆ 1", "è…“ 3-4ï¼›æ­Œ 1-4ï¼›å¸–å‰ 1-4"],
                ["2026-04-09", "å››", "å“ˆ 2", "å¸–å‰ 5ï¼›å¸–å¾Œ 1-3ï¼›æå‰ 1-6"],
                ["2026-04-10", "äº”", "å“ˆ 3 (å·çµ‚)", "æå¾Œ 1-4ï¼›å¤š 1-3ï¼›é–€ï¼›ä¾† 1-2"], // å¸Œ -> ä¾†
                ["2026-04-11", "å…­", "æ—å‰ 12", "ä¾† 3-12"], // å¸Œ -> ä¾†
                ["2026-04-12", "æ—¥", "æ—å‰ 13", "ä¾† 13ï¼›é›… 1-5ï¼›å½¼å‰ 1-4"], // å¸Œ -> ä¾†
                ["2026-04-13", "ä¸€", "æ—å‰ 14", "å½¼å‰ 5ï¼›å½¼å¾Œ 1-3ï¼›ç´„ä¸€ 1-5ï¼›ç´„äºŒ"],
                ["2026-04-14", "äºŒ", "ç•ª 1", "ç´„ä¸‰ï¼›çŒ¶ï¼›å•Ÿ 1-8"],
                ["2026-04-15", "ä¸‰", "ç•ª 2", "å•Ÿ 9-18"],
                ["2026-04-16", "å››", "ç•ª 3 (å·çµ‚)", "å•Ÿ 19-22ï¼›å‰µ 1-6 (ç¬¬ä¸€éè®€å®Œ)"],
                ["2026-04-17", "äº”", "è©² 1", "å‰µ 7-16"],
                ["2026-04-18", "å…­", "æ—å‰ 15", "å‰µ 17-26"],
                ["2026-04-19", "æ—¥", "æ—å‰ 16 (å·çµ‚)", "å‰µ 27-36"],
                ["2026-04-20", "ä¸€", "æ—å¾Œ 1", "å‰µ 37-46"],
                ["2026-04-21", "äºŒ", "è©² 2 (å·çµ‚)", "å‰µ 47-50ï¼›å‡º 1-6"],
                ["2026-04-22", "ä¸‰", "äº 1", "å‡º 7-16"],
                ["2026-04-23", "å››", "äº 2", "å‡º 17-26"],
                ["2026-04-24", "äº”", "äº 3", "å‡º 27-36"],
                ["2026-04-25", "å…­", "æ—å¾Œ 2", "å‡º 37-40ï¼›åˆ© 1-6"],
                ["2026-04-26", "æ—¥", "æ—å¾Œ 3", "åˆ© 7-16"],
                ["2026-04-27", "ä¸€", "æ—å¾Œ 4", "åˆ© 17-26"],
                ["2026-04-28", "äºŒ", "äº 4", "åˆ© 27ï¼›æ°‘ 1-9"],
                ["2026-04-29", "ä¸‰", "äº 5", "æ°‘ 10-19"],
                ["2026-04-30", "å››", "äº 6", "æ°‘ 20-29"],
                ["2026-05-01", "äº”", "äº 7", "æ°‘ 30-36ï¼›ç”³ 1-3"],
                ["2026-05-02", "å…­", "æ—å¾Œ 5", "ç”³ 4-13"],
                ["2026-05-03", "æ—¥", "æ—å¾Œ 6", "ç”³ 14-23"],
                ["2026-05-04", "ä¸€", "æ—å¾Œ 7", "ç”³ 24-33"],
                ["2026-05-05", "äºŒ", "äº 8", "ç”³ 34ï¼›æ›¸ 1-9"],
                ["2026-05-06", "ä¸‰", "äº 9", "æ›¸ 10-19"],
                ["2026-05-07", "å››", "äº 10", "æ›¸ 20-24ï¼›å£« 1-5"],
                ["2026-05-08", "äº”", "äº 11", "å£« 6-15"],
                ["2026-05-09", "å…­", "æ—å¾Œ 8", "å£« 16-21ï¼›å¾— 1-4"],
                ["2026-05-10", "æ—¥", "æ—å¾Œ 9", "æ’’ä¸Š 1-10"],
                ["2026-05-11", "ä¸€", "æ—å¾Œ 10", "æ’’ä¸Š 11-20"],
                ["2026-05-12", "äºŒ", "äº 12", "æ’’ä¸Š 21-30"],
                ["2026-05-13", "ä¸‰", "äº 13", "æ’’ä¸Š 31ï¼›æ’’ä¸‹ 1-9"],
                ["2026-05-14", "å››", "äº 14 (å·çµ‚)", "æ’’ä¸‹ 10-19"],
                ["2026-05-15", "äº”", "ç‘ª 1", "æ’’ä¸‹ 20-24ï¼›ç‹ä¸Š 1-5"],
                ["2026-05-16", "å…­", "æ—å¾Œ 11", "ç‹ä¸Š 6-15"],
                ["2026-05-17", "æ—¥", "æ—å¾Œ 12", "ç‹ä¸Š 16-22ï¼›ç‹ä¸‹ 1-3"],
                ["2026-05-18", "ä¸€", "æ—å¾Œ 13 (å·çµ‚)", "ç‹ä¸‹ 4-13"],
                ["2026-05-19", "äºŒ", "ç‘ª 2", "ç‹ä¸‹ 14-23"],
                ["2026-05-20", "ä¸‰", "ç‘ª 3", "ç‹ä¸‹ 24-25ï¼›ä»£ä¸Š 1-8"],
                ["2026-05-21", "å››", "ç‘ª 4 (èˆŠç´„ä¸€éçµ‚)", "ä»£ä¸Š 9-18"],
                ["2026-05-22", "äº”", "å‰µ 1 (æ–°å¾ªç’°)", "ä»£ä¸Š 19-28"],
                ["2026-05-23", "å…­", "åŠ  1", "ä»£ä¸Š 29ï¼›ä»£ä¸‹ 1-9"],
                ["2026-05-24", "æ—¥", "åŠ  2", "ä»£ä¸‹ 10-19"],
                ["2026-05-25", "ä¸€", "åŠ  3", "ä»£ä¸‹ 20-29"],
                ["2026-05-26", "äºŒ", "å‰µ 2", "ä»£ä¸‹ 30-36ï¼›æ‹‰ 1-3"],
                ["2026-05-27", "ä¸‰", "å‰µ 3", "æ‹‰ 4-10ï¼›å°¼ 1-3"],
                ["2026-05-28", "å››", "å‰µ 4", "å°¼ 4-13"],
                ["2026-05-29", "äº”", "å‰µ 5", "æ–¯ 1-10"],
                ["2026-05-30", "å…­", "åŠ  4", "ä¼¯ 1-10"],
                ["2026-05-31", "æ—¥", "åŠ  5", "ä¼¯ 11-20"],
                ["2026-06-01", "ä¸€", "åŠ  6 (å·çµ‚)", "ä¼¯ 21-30"],
                ["2026-06-02", "äºŒ", "å‰µ 6", "ä¼¯ 31-40"],
                ["2026-06-03", "ä¸‰", "å‰µ 7", "ä¼¯ 41-42ï¼›è©© 1-8"],
                ["2026-06-04", "å››", "å‰µ 8", "è©© 9-18"],
                ["2026-06-05", "äº”", "å‰µ 9", "è©© 19-28"],
                ["2026-06-06", "å…­", "å¼— 1", "è©© 29-38"],
                ["2026-06-07", "æ—¥", "å¼— 2", "è©© 39-48"],
                ["2026-06-08", "ä¸€", "å¼— 3", "è©© 49-58"],
                ["2026-06-09", "äºŒ", "å‰µ 10", "è©© 59-68"],
                ["2026-06-10", "ä¸‰", "å‰µ 11", "è©© 69-78"],
                ["2026-06-11", "å››", "å‰µ 12", "è©© 79-88"],
                ["2026-06-12", "äº”", "å‰µ 13", "è©© 89-98"],
                ["2026-06-13", "å…­", "å¼— 4", "è©© 99-108"],
                ["2026-06-14", "æ—¥", "å¼— 5", "è©© 109-118"],
                ["2026-06-15", "ä¸€", "å¼— 6 (å·çµ‚)", "è©© 119-128"],
                ["2026-06-16", "äºŒ", "å‰µ 14", "è©© 129-138"],
                ["2026-06-17", "ä¸‰", "å‰µ 15", "è©© 139-148"],
                ["2026-06-18", "å››", "å‰µ 16", "è©© 149-150ï¼›ç®´ 1-8"],
                ["2026-06-19", "äº”", "å‰µ 17", "ç®´ 9-18"],
                ["2026-06-20", "å…­", "è…“ 1", "ç®´ 19-28"],
                ["2026-06-21", "æ—¥", "è…“ 2", "ç®´ 29-31ï¼›å‚³ 1-7"],
                ["2026-06-22", "ä¸€", "è…“ 3", "å‚³ 8-12ï¼›æ­Œ 1-5"],
                ["2026-06-23", "äºŒ", "å‰µ 18", "æ­Œ 6-8ï¼›è³½ 1-7"],
                ["2026-06-24", "ä¸‰", "å‰µ 19", "è³½ 8-17"],
                ["2026-06-25", "å››", "å‰µ 20", "è³½ 18-27"],
                ["2026-06-26", "äº”", "å‰µ 21", "è³½ 28-37"],
                ["2026-06-27", "å…­", "è…“ 4 (å·çµ‚)", "è³½ 38-47"],
                ["2026-06-28", "æ—¥", "è¥¿ 1", "è³½ 48-57"],
                ["2026-06-29", "ä¸€", "è¥¿ 2", "è³½ 58-66ï¼›è€¶ 1"],
                ["2026-06-30", "äºŒ", "å‰µ 22", "è€¶ 2-11"],
                ["2026-07-01", "ä¸‰", "å‰µ 23", "è€¶ 12-21"],
                ["2026-07-02", "å››", "å‰µ 24", "è€¶ 22-31"],
                ["2026-07-03", "äº”", "å‰µ 25", "è€¶ 32-41"],
                ["2026-07-04", "å…­", "è¥¿ 3", "è€¶ 42-51"],
                ["2026-07-05", "æ—¥", "è¥¿ 4 (å·çµ‚)", "è€¶ 52ï¼›å“€ 1-5ï¼›çµ 1-4"],
                ["2026-07-06", "ä¸€", "å¸–å‰ 1", "çµ 5-14"],
                ["2026-07-07", "äºŒ", "å‰µ 26", "çµ 15-24"],
                ["2026-07-08", "ä¸‰", "å‰µ 27", "çµ 25-34"],
                ["2026-07-09", "å››", "å‰µ 28", "çµ 35-44"],
                ["2026-07-10", "äº”", "å‰µ 29", "çµ 45-48ï¼›ä½† 1-6"],
                ["2026-07-11", "å…­", "å¸–å‰ 2", "ä½† 7-12ï¼›ä½• 1-4"],
                ["2026-07-12", "æ—¥", "å¸–å‰ 3", "ä½• 5-14"],
                ["2026-07-13", "ä¸€", "å¸–å‰ 4", "ç¥ 1-3ï¼›æ‘© 1-7"],
                ["2026-07-14", "äºŒ", "å‰µ 30", "æ‘© 8-9ï¼›ä¿„ï¼›æ‹¿ï¼›å½Œ 1-3"],
                ["2026-07-15", "ä¸‰", "å‰µ 31", "å½Œ 4-7ï¼›é´» 1-3ï¼›å“ˆ 1-3"],
                ["2026-07-16", "å››", "å‰µ 32", "ç•ª 1-3ï¼›è©² 1-2ï¼›äº 1-5"],
                ["2026-07-17", "äº”", "å‰µ 33", "äº 6-14ï¼›ç‘ª 1"],
                ["2026-07-18", "å…­", "å¸–å‰ 5 (å·çµ‚)", "ç‘ª 2-4ï¼›å¤ª 1-7"],
                ["2026-07-19", "æ—¥", "å¸–å¾Œ 1", "å¤ª 8-17"],
                ["2026-07-20", "ä¸€", "å¸–å¾Œ 2", "å¤ª 18-27"],
                ["2026-07-21", "äºŒ", "å‰µ 34", "å¤ª 28ï¼›å¯ 1-9"],
                ["2026-07-22", "ä¸‰", "å‰µ 35", "å¯ 10-16ï¼›è·¯ 1-3"],
                ["2026-07-23", "å››", "å‰µ 36", "è·¯ 4-13"],
                ["2026-07-24", "äº”", "å‰µ 37", "è·¯ 14-23"],
                ["2026-07-25", "å…­", "å¸–å¾Œ 3 (å·çµ‚)", "è·¯ 24ï¼›ç´„ 1-9"],
                ["2026-07-26", "æ—¥", "æå‰ 1", "ç´„ 10-19"],
                ["2026-07-27", "ä¸€", "æå‰ 2", "ç´„ 20-21ï¼›å¾’ 1-8"],
                ["2026-07-28", "äºŒ", "å‰µ 38", "å¾’ 9-18"],
                ["2026-07-29", "ä¸‰", "å‰µ 39", "å¾’ 19-28"],
                ["2026-07-30", "å››", "å‰µ 40", "ç¾… 1-10"],
                ["2026-07-31", "äº”", "å‰µ 41", "ç¾… 11-16ï¼›æ—å‰ 1-4"],
                ["2026-08-01", "å…­", "æå‰ 3", "æ—å‰ 5-14"],
                ["2026-08-02", "æ—¥", "æå‰ 4", "æ—å‰ 15-16ï¼›æ—å¾Œ 1-8"],
                ["2026-08-03", "ä¸€", "æå‰ 5", "æ—å¾Œ 9-13ï¼›åŠ  1-5"],
                ["2026-08-04", "äºŒ", "å‰µ 42", "åŠ  6ï¼›å¼— 1-6ï¼›è…“ 1-3"],
                ["2026-08-05", "ä¸‰", "å‰µ 43", "è…“ 4ï¼›æ­Œ 1-4ï¼›å¸–å‰ 1-5"],
                ["2026-08-06", "å››", "å‰µ 44", "å¸–å¾Œ 1-3ï¼›æå‰ 1-6ï¼›æå¾Œ 1"],
                ["2026-08-07", "äº”", "å‰µ 45", "æå¾Œ 2-4ï¼›å¤š 1-3ï¼›é–€ï¼›ä¾† 1-3"], // å¸Œ -> ä¾†
                ["2026-08-08", "å…­", "æå‰ 6 (å·çµ‚)", "ä¾† 4-13"], // å¸Œ -> ä¾†
                ["2026-08-09", "æ—¥", "æå¾Œ 1", "é›… 1-5ï¼›å½¼å‰ 1-5"],
                ["2026-08-10", "ä¸€", "æå¾Œ 2", "å½¼å¾Œ 1-3ï¼›ç´„ä¸€ 1-5ï¼›ç´„äºŒï¼›ç´„ä¸‰"],
                ["2026-08-11", "äºŒ", "å‰µ 46", "çŒ¶ï¼›å•Ÿ 1-9"],
                ["2026-08-12", "ä¸‰", "å‰µ 47", "å•Ÿ 10-19"],
                ["2026-08-13", "å››", "å‰µ 48", "å•Ÿ 20-22ï¼›å‰µ 1-7 (ç¬¬ä¸‰éè®€å®Œ)"],
                ["2026-08-14", "äº”", "å‰µ 49", "å‰µ 8-17"],
                ["2026-08-15", "å…­", "æå¾Œ 3", "å‰µ 18-27"],
                ["2026-08-16", "æ—¥", "æå¾Œ 4 (å·çµ‚)", "å‰µ 28-37"],
                ["2026-08-17", "ä¸€", "å¤š 1", "å‰µ 38-47"],
                ["2026-08-18", "äºŒ", "å‰µ 50 (å·çµ‚)", "å‰µ 48-50ï¼›å‡º 1-7"],
                ["2026-08-19", "ä¸‰", "å‡º 1", "å‡º 8-17"],
                ["2026-08-20", "å››", "å‡º 2", "å‡º 18-27"],
                ["2026-08-21", "äº”", "å‡º 3", "å‡º 28-37"],
                ["2026-08-22", "å…­", "å¤š 2", "å‡º 38-40ï¼›åˆ© 1-7"],
                ["2026-08-23", "æ—¥", "å¤š 3 (å·çµ‚)", "åˆ© 8-17"],
                ["2026-08-24", "ä¸€", "é–€", "åˆ© 18-27"],
                ["2026-08-25", "äºŒ", "å‡º 4", "æ°‘ 1-10"],
                ["2026-08-26", "ä¸‰", "å‡º 5", "æ°‘ 11-20"],
                ["2026-08-27", "å››", "å‡º 6", "æ°‘ 21-30"],
                ["2026-08-28", "äº”", "å‡º 7", "æ°‘ 31-36ï¼›ç”³ 1-4"],
                ["2026-08-29", "å…­", "å¸Œ 1", "ç”³ 5-14"], // æ­¤è™•ç¶­æŒå…¨åæˆ–ç°¡ç¨±ï¼Œå¾ŒçºŒ formatCalendarDisplay æœƒè™•ç†
                ["2026-08-30", "æ—¥", "å¸Œ 2", "ç”³ 15-24"],
                ["2026-08-31", "ä¸€", "å¸Œ 3", "ç”³ 25-34"],
                ["2026-09-01", "äºŒ", "å‡º 8", "æ›¸ 1-10"],
                ["2026-09-02", "ä¸‰", "å‡º 9", "æ›¸ 11-20"],
                ["2026-09-03", "å››", "å‡º 10", "æ›¸ 21-24ï¼›å£« 1-6"],
                ["2026-09-04", "äº”", "å‡º 11", "å£« 7-16"],
                ["2026-09-05", "å…­", "å¸Œ 4", "å£« 17-21ï¼›å¾— 1-4ï¼›æ’’ä¸Š 1"],
                ["2026-09-06", "æ—¥", "å¸Œ 5", "æ’’ä¸Š 2-11"],
                ["2026-09-07", "ä¸€", "å¸Œ 6", "æ’’ä¸Š 12-21"],
                ["2026-09-08", "äºŒ", "å‡º 12", "æ’’ä¸Š 22-31"],
                ["2026-09-09", "ä¸‰", "å‡º 13", "æ’’ä¸‹ 1-10"],
                ["2026-09-10", "å››", "å‡º 14", "æ’’ä¸‹ 11-20"],
                ["2026-09-11", "äº”", "å‡º 15", "æ’’ä¸‹ 21-24ï¼›ç‹ä¸Š 1-6"],
                ["2026-09-12", "å…­", "å¸Œ 7", "ç‹ä¸Š 7-16"],
                ["2026-09-13", "æ—¥", "å¸Œ 8", "ç‹ä¸Š 17-22ï¼›ç‹ä¸‹ 1-4"],
                ["2026-09-14", "ä¸€", "å¸Œ 9", "ç‹ä¸‹ 5-14"],
                ["2026-09-15", "äºŒ", "å‡º 16", "ç‹ä¸‹ 15-24"],
                ["2026-09-16", "ä¸‰", "å‡º 17", "ç‹ä¸‹ 25ï¼›ä»£ä¸Š 1-9"],
                ["2026-09-17", "å››", "å‡º 18", "ä»£ä¸Š 10-19"],
                ["2026-09-18", "äº”", "å‡º 19", "ä»£ä¸Š 20-29"],
                ["2026-09-19", "å…­", "å¸Œ 10", "ä»£ä¸‹ 1-10"],
                ["2026-09-20", "æ—¥", "å¸Œ 11", "ä»£ä¸‹ 11-20"],
                ["2026-09-21", "ä¸€", "å¸Œ 12", "ä»£ä¸‹ 21-30"],
                ["2026-09-22", "äºŒ", "å‡º 20", "ä»£ä¸‹ 31-36ï¼›æ‹‰ 1-4"],
                ["2026-09-23", "ä¸‰", "å‡º 21", "æ‹‰ 5-10ï¼›å°¼ 1-4"],
                ["2026-09-24", "å››", "å‡º 22", "å°¼ 5-13ï¼›æ–¯ 1"],
                ["2026-09-25", "äº”", "å‡º 23", "æ–¯ 2-10ï¼›ä¼¯ 1"],
                ["2026-09-26", "å…­", "å¸Œ 13 (å·çµ‚)", "ä¼¯ 2-11"],
                ["2026-09-27", "æ—¥", "é›… 1", "ä¼¯ 12-21"],
                ["2026-09-28", "ä¸€", "é›… 2", "ä¼¯ 22-31"],
                ["2026-09-29", "äºŒ", "å‡º 24", "ä¼¯ 32-41"],
                ["2026-09-30", "ä¸‰", "å‡º 25", "ä¼¯ 42ï¼›è©© 1-9"],
                ["2026-10-01", "å››", "å‡º 26", "è©© 10-19"],
                ["2026-10-02", "äº”", "å‡º 27", "è©© 20-29"],
                ["2026-10-03", "å…­", "é›… 3", "è©© 30-39"],
                ["2026-10-04", "æ—¥", "é›… 4", "è©© 40-49"],
                ["2026-10-05", "ä¸€", "é›… 5 (å·çµ‚)", "è©© 50-59"],
                ["2026-10-06", "äºŒ", "å‡º 28", "è©© 60-69"],
                ["2026-10-07", "ä¸‰", "å‡º 29", "è©© 70-79"],
                ["2026-10-08", "å››", "å‡º 30", "è©© 80-89"],
                ["2026-10-09", "äº”", "å‡º 31", "è©© 90-99"],
                ["2026-10-10", "å…­", "å½¼å‰ 1", "è©© 100-109"],
                ["2026-10-11", "æ—¥", "å½¼å‰ 2", "è©© 110-119"],
                ["2026-10-12", "ä¸€", "å½¼å‰ 3", "è©© 120-129"],
                ["2026-10-13", "äºŒ", "å‡º 32", "è©© 130-139"],
                ["2026-10-14", "ä¸‰", "å‡º 33", "è©© 140-149"],
                ["2026-10-15", "å››", "å‡º 34", "è©© 150ï¼›ç®´ 1-9"],
                ["2026-10-16", "äº”", "å‡º 35", "ç®´ 10-19"],
                ["2026-10-17", "å…­", "å½¼å‰ 4", "ç®´ 20-29"],
                ["2026-10-18", "æ—¥", "å½¼å‰ 5 (å·çµ‚)", "ç®´ 30-31ï¼›å‚³ 1-8"],
                ["2026-10-19", "ä¸€", "å½¼å¾Œ 1", "å‚³ 9-12ï¼›æ­Œ 1-6"],
                ["2026-10-20", "äºŒ", "å‡º 36", "æ­Œ 7-8ï¼›è³½ 1-8"],
                ["2026-10-21", "ä¸‰", "å‡º 37", "è³½ 9-18"],
                ["2026-10-22", "å››", "å‡º 38", "è³½ 19-28"],
                ["2026-10-23", "äº”", "å‡º 39", "è³½ 29-38"],
                ["2026-10-24", "å…­", "å½¼å¾Œ 2", "è³½ 39-48"],
                ["2026-10-25", "æ—¥", "å½¼å¾Œ 3 (å·çµ‚)", "è³½ 49-58"],
                ["2026-10-26", "ä¸€", "ç´„ä¸€ 1", "è³½ 59-66ï¼›è€¶ 1-2"],
                ["2026-10-27", "äºŒ", "å‡º 40 (å·çµ‚)", "è€¶ 3-12"],
                ["2026-10-28", "ä¸‰", "åˆ© 1", "è€¶ 13-22"],
                ["2026-10-29", "å››", "åˆ© 2", "è€¶ 23-32"],
                ["2026-10-30", "äº”", "åˆ© 3", "è€¶ 33-42"],
                ["2026-10-31", "å…­", "ç´„ä¸€ 2", "è€¶ 43-52"],
                ["2026-11-01", "æ—¥", "ç´„ä¸€ 3", "å“€ 1-5ï¼›çµ 1-5"],
                ["2026-11-02", "ä¸€", "ç´„ä¸€ 4", "çµ 6-15"],
                ["2026-11-03", "äºŒ", "åˆ© 4", "çµ 16-25"],
                ["2026-11-04", "ä¸‰", "åˆ© 5", "çµ 26-35"],
                ["2026-11-05", "å››", "åˆ© 6", "çµ 36-45"],
                ["2026-11-06", "äº”", "åˆ© 7", "çµ 46-48ï¼›ä½† 1-7"],
                ["2026-11-07", "å…­", "ç´„ä¸€ 5 (å·çµ‚)", "ä½† 8-12ï¼›ä½• 1-5"],
                ["2026-11-08", "æ—¥", "ç´„äºŒ", "ä½• 6-14ï¼›ç¥ 1"],
                ["2026-11-09", "ä¸€", "ç´„ä¸‰", "ç¥ 2-3ï¼›æ‘© 1-8"],
                ["2026-11-10", "äºŒ", "åˆ© 8", "æ‘© 9ï¼›ä¿„ï¼›æ‹¿ï¼›å½Œ 1-4"],
                ["2026-11-11", "ä¸‰", "åˆ© 9", "å½Œ 5-7ï¼›é´»ï¼›å“ˆï¼›ç•ª 1-2"],
                ["2026-11-12", "å››", "åˆ© 10", "ç•ª 3ï¼›è©²ï¼›äº 1-7"],
                ["2026-11-13", "äº”", "åˆ© 11", "äº 8-14ï¼›ç‘ª 1-3"],
                ["2026-11-14", "å…­", "çŒ¶", "ç‘ª 4ï¼›å¤ª 1-9"],
                ["2026-11-15", "æ—¥", "å•Ÿ 1", "å¤ª 10-19"],
                ["2026-11-16", "ä¸€", "å•Ÿ 2", "å¤ª 20-29"],
                ["2026-11-17", "äºŒ", "åˆ© 12", "å¤ª 30ï¼›å¯ 1-9"],
                ["2026-11-18", "ä¸‰", "åˆ© 13", "å¯ 10-16ï¼›è·¯ 1-3"],
                ["2026-11-19", "å››", "åˆ© 14", "è·¯ 4-13"],
                ["2026-11-20", "äº”", "åˆ© 15", "è·¯ 14-23"],
                ["2026-11-21", "å…­", "å•Ÿ 3", "è·¯ 24ï¼›ç´„ 1-9"],
                ["2026-11-22", "æ—¥", "å•Ÿ 4", "ç´„ 10-19"],
                ["2026-11-23", "ä¸€", "å•Ÿ 5", "ç´„ 20-21ï¼›å¾’ 1-8"],
                ["2026-11-24", "äºŒ", "åˆ© 16", "å¾’ 9-18"],
                ["2026-11-25", "ä¸‰", "åˆ© 17", "å¾’ 19-28"],
                ["2026-11-26", "å››", "åˆ© 18", "ç¾… 1-10"],
                ["2026-11-27", "äº”", "åˆ© 19", "ç¾… 11-16ï¼›æ—å‰ 1-4"],
                ["2026-11-28", "å…­", "å•Ÿ 6", "æ—å‰ 5-14"],
                ["2026-11-29", "æ—¥", "å•Ÿ 7", "æ—å‰ 15-16ï¼›æ—å¾Œ 1-8"],
                ["2026-11-30", "ä¸€", "å•Ÿ 8", "æ—å¾Œ 9-13ï¼›åŠ  1-5"],
                ["2026-12-01", "äºŒ", "åˆ© 20", "åŠ  6ï¼›å¼— 1-6ï¼›è…“ 1-3"],
                ["2026-12-02", "ä¸‰", "åˆ© 21", "è…“ 4ï¼›æ­Œ 1-4ï¼›å¸–å‰ 1-5"],
                ["2026-12-03", "å››", "åˆ© 22", "å¸–å¾Œ 1-3ï¼›æå‰ 1-6ï¼›æå¾Œ 1"],
                ["2026-12-04", "äº”", "åˆ© 23", "æå¾Œ 2-4ï¼›å¤š 1-3ï¼›é–€ï¼›ä¾† 1-3"], // å¸Œ -> ä¾†
                ["2026-12-05", "å…­", "å•Ÿ 9", "ä¾† 4-13"], // å¸Œ -> ä¾†
                ["2026-12-06", "æ—¥", "å•Ÿ 10", "é›… 1-5ï¼›å½¼å‰ 1-5"],
                ["2026-12-07", "ä¸€", "å•Ÿ 11", "å½¼å¾Œï¼›ç´„ä¸€ï¼›ç´„äºŒï¼›ç´„ä¸‰"],
                ["2026-12-08", "äºŒ", "åˆ© 24", "çŒ¶ï¼›å•Ÿ 1-9"],
                ["2026-12-09", "ä¸‰", "åˆ© 25", "å•Ÿ 10-19"],
                ["2026-12-10", "å››", "åˆ© 26", "å•Ÿ 20-22ï¼›å‰µ 1-7 (ç¬¬ä¸‰éè®€å®Œ)"],
                ["2026-12-11", "äº”", "åˆ© 27 (å·çµ‚)", "å‰µ 8-17"],
                ["2026-12-12", "å…­", "å•Ÿ 12", "å‰µ 18-27"],
                ["2026-12-13", "æ—¥", "å•Ÿ 13", "å‰µ 28-37"],
                ["2026-12-14", "ä¸€", "å•Ÿ 14", "å‰µ 38-47"],
                ["2026-12-15", "äºŒ", "æ°‘ 1", "å‰µ 48-50ï¼›å‡º 1-7"],
                ["2026-12-16", "ä¸‰", "æ°‘ 2", "å‡º 8-17"],
                ["2026-12-17", "å››", "æ°‘ 3", "å‡º 18-27"],
                ["2026-12-18", "äº”", "æ°‘ 4", "å‡º 28-37"],
                ["2026-12-19", "å…­", "å•Ÿ 15", "å‡º 38-40ï¼›åˆ© 1-7"],
                ["2026-12-20", "æ—¥", "å•Ÿ 16", "åˆ© 8-17"],
                ["2026-12-21", "ä¸€", "å•Ÿ 17", "åˆ© 18-27"],
                ["2026-12-22", "äºŒ", "æ°‘ 5", "æ°‘ 1-10"],
                ["2026-12-23", "ä¸‰", "æ°‘ 6", "æ°‘ 11-20"],
                ["2026-12-24", "å››", "æ°‘ 7", "æ°‘ 21-30"],
                ["2026-12-25", "äº”", "æ°‘ 8", "æ°‘ 31-36ï¼›ç”³ 1-4"],
                ["2026-12-26", "å…­", "å•Ÿ 18", "ç”³ 5-14"],
                ["2026-12-27", "æ—¥", "å•Ÿ 19", "ç”³ 15-24"],
                ["2026-12-28", "ä¸€", "å•Ÿ 20", "ç”³ 25-34"],
                ["2026-12-29", "äºŒ", "æ°‘ 9", "æ›¸ 1-10"],
                ["2026-12-30", "ä¸‰", "æ°‘ 10", "æ›¸ 11-20"],
                ["2026-12-31", "å››", "æ°‘ 11", "æ›¸ 21-24ï¼›å£« 1-6"]
            ];
            year2025_Dec.forEach(d => addDay(d[0], d[1], d[2], d[3]));
            year2026.forEach(d => addDay(d[0], d[1], d[2], d[3]));
            return plans;
        };

        const BibleReader = ({ bookId, chapter, label, lang }) => {
            const [content, setContent] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                const fetchScripture = async () => {
                    setLoading(true);
                    setError(null);
                    if (!bookId || !chapter) {
                        setError(lang === 'zh' ? "ç„¡æ³•è­˜åˆ¥ç¶“æ–‡" : "Unknown Reference");
                        setLoading(false);
                        return;
                    }
                    try {
                        const version = lang === 'en' ? 'WEB' : 'CUV';
                        const response = await fetch(`https://bolls.life/get-chapter/${version}/${bookId}/${chapter}/`);
                        if (!response.ok) throw new Error("API Error");
                        const data = await response.json();
                        if (!Array.isArray(data)) throw new Error("Format Error");
                        setContent(data);
                    } catch (err) {
                        setError(lang === 'zh' ? "è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯ã€‚" : "Failed to load scripture.");
                    } finally {
                        setLoading(false);
                    }
                };
                fetchScripture();
            }, [bookId, chapter, lang]);

            const t = TRANSLATIONS[lang];

            if (loading) return (
                <div className="flex flex-col items-center justify-center p-8 text-gray-400 gap-2 min-h-[150px] bg-gray-50 rounded-lg">
                    <RefreshCw className="animate-spin" size={24} />
                    <span className="text-sm">{t.loading}</span>
                </div>
            );

            if (error) return <div className="p-6 text-center text-red-500 bg-red-50 rounded-lg"><p>{error}</p></div>;

            return (
                <div className="bg-[#fffdf7] rounded-xl border border-gray-200 shadow-inner max-h-[60vh] flex flex-col mt-4 animate-in slide-in-from-top-2 fade-in overflow-hidden">
                    <div className="flex-none p-4 border-b border-gray-200 bg-[#fffdf7] z-10 flex justify-between items-center">
                        <h3 className="text-xl font-bold text-gray-800">{label}</h3>
                        <span className="text-xs font-normal text-gray-400">({t.version})</span>
                    </div>
                    <div className="flex-1 overflow-y-auto p-6 custom-scrollbar">
                        <div className="text-lg leading-relaxed text-gray-700 space-y-2 font-serif">
                            {content.map((v) => (
                                <div key={v.pk} className="flex gap-2 hover:bg-yellow-50/50 p-0.5 rounded transition-colors">
                                    <span className="text-xs text-gray-400 font-sans mt-1.5 w-6 text-right shrink-0 select-none">{v.verse}</span>
                                    <p className="flex-1">{v.text}</p>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const PrintPreviewOverlay = ({ year, selectedMonths, plans, lang, onClose }) => {
            const t = TRANSLATIONS[lang];
            const contentRef = useRef(null);
            const [isGenerating, setIsGenerating] = useState(false);
            
            const pagesData = useMemo(() => {
                return selectedMonths.sort((a,b) => a-b).map(month => {
                    const prefix = `${year}-${String(month).padStart(2,'0')}`;
                    const monthPlans = plans.filter(p => p.date.startsWith(prefix));
                    return { month, plans: monthPlans };
                });
            }, [year, selectedMonths, plans]);

            const handlePrint = () => {
                if (!contentRef.current) return;
                const printWindow = window.open('', '_blank');
                if (!printWindow) { alert("è«‹å…è¨±æœ¬ç¶²ç«™é–‹å•Ÿå½ˆè·³è¦–çª—ä»¥é€²è¡Œåˆ—å°"); return; }
                const styles = Array.from(document.querySelectorAll('style, link[rel="stylesheet"]')).map(style => style.outerHTML).join('\n');
                const content = contentRef.current.innerHTML;
                printWindow.document.write(`<!DOCTYPE html><html><head><title>PJBC Schedule Print</title><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><script src="https://cdn.tailwindcss.com"><\/script><script>tailwind.config = {theme: {extend: {screens: {'print': {'raw': 'print'}}}}}}<\/script>${styles}<style>body{background-color:white!important;margin:0;padding:0;-webkit-print-color-adjust:exact!important;print-color-adjust:exact!important;}::-webkit-scrollbar{display:none;}</style></head><body><div id="print-preview-root" style="position:static;width:100%;height:auto;overflow:visible;">${content}</div><script>window.onload=function(){setTimeout(function(){window.print();},800);};<\/script></body></html>`);
                printWindow.document.close();
            };

            const handleDownloadAllPNGs = async () => {
                if (!contentRef.current) return;
                setIsGenerating(true);
                try {
                    const pages = contentRef.current.querySelectorAll('.print-page-container');
                    if (pages.length === 1) {
                        const page = pages[0];
                        const canvas = await html2canvas(page, { scale: 2 });
                        const link = document.createElement('a');
                        const month = pagesData[0] ? pagesData[0].month : 1;
                        link.download = `PJBC_Schedule_${year}_${month}.png`;
                        link.href = canvas.toDataURL('image/png');
                        link.click();
                    } else if (pages.length > 1) {
                        const zip = new JSZip();
                        for (let i = 0; i < pages.length; i++) {
                            const page = pages[i];
                            await new Promise(r => setTimeout(r, 100));
                            const canvas = await html2canvas(page, { scale: 2 });
                            const imgData = canvas.toDataURL('image/png');
                            const base64Data = imgData.split(',')[1];
                            const month = pagesData[i] ? pagesData[i].month : (i + 1);
                            zip.file(`PJBC_Schedule_${year}_${month}.png`, base64Data, { base64: true });
                        }
                        const content = await zip.generateAsync({ type: "blob" });
                        const link = document.createElement('a');
                        link.href = window.URL.createObjectURL(content);
                        link.download = `PJBC_Schedule_${year}_Images.zip`;
                        link.click();
                    }
                } catch (err) {
                    console.error("PNG/ZIP Generation failed", err);
                    alert("åœ–ç‰‡ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦");
                } finally {
                    setIsGenerating(false);
                }
            };

            const handleDownloadPDF = async () => {
                if (!contentRef.current) return;
                setIsGenerating(true);
                try {
                    const element = contentRef.current;
                    const opt = {
                        margin: 0, 
                        filename: `PJBC_Schedule_${year}.pdf`,
                        image: { type: 'jpeg', quality: 0.98 },
                        html2canvas: { scale: 2 },
                        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
                    };
                    await html2pdf().set(opt).from(element).save();
                } catch (err) {
                    console.error("PDF Generation failed", err);
                    alert("PDF ç”Ÿæˆå¤±æ•—ï¼Œè«‹é‡è©¦");
                } finally {
                    setIsGenerating(false);
                }
            };

            return (
                <div className="fixed inset-0 z-[9999] bg-gray-100 overflow-auto flex flex-col">
                    <div className="no-print-in-preview sticky top-0 bg-gray-900 text-white p-4 shadow-md flex flex-wrap justify-between items-center z-50 gap-4">
                        <div className="font-bold flex items-center gap-2 text-lg">
                            <FileText size={24} className="text-blue-400"/> {t.print_preview_btn}
                        </div>
                        <div className="flex flex-wrap gap-2 md:gap-3">
                            {isGenerating ? (
                                <div className="px-4 py-2 text-gray-300 flex items-center gap-2">
                                    <RefreshCw className="animate-spin" size={16}/> Processing...
                                </div>
                            ) : (
                                <>
                                    <button onClick={handleDownloadAllPNGs} className="px-3 md:px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded text-sm transition-colors flex items-center gap-2 border border-gray-600">
                                        <ImageIcon size={16}/> <span className="hidden md:inline">{t.download_png}</span>
                                    </button>
                                    <button onClick={handleDownloadPDF} className="px-3 md:px-4 py-2 bg-indigo-600 hover:bg-indigo-500 text-white rounded text-sm transition-colors flex items-center gap-2 shadow-sm">
                                        <FileDown size={16}/> {t.download_pdf}
                                    </button>
                                    <button onClick={handlePrint} className="px-3 md:px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-bold rounded text-sm shadow-lg transition-all flex items-center gap-2">
                                        <Printer size={16}/> {t.print_now}
                                    </button>
                                </>
                            )}
                            <div className="w-px h-8 bg-gray-700 mx-1 hidden md:block"></div>
                            <button onClick={onClose} className="px-3 md:px-4 py-2 bg-red-600/90 hover:bg-red-500 rounded text-sm transition-colors flex items-center gap-2 text-white">
                                <X size={16}/> {t.close_preview}
                            </button>
                        </div>
                    </div>
                    <div className="flex-1 p-4 md:p-8 print:p-0 flex justify-center print:block overflow-x-hidden bg-gray-200">
                        <div ref={contentRef} className="print:w-full">
                            {pagesData.map((page, idx) => {
                                const monthLabel = lang === 'en' ? ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"][page.month - 1] : page.month;
                                const monthFontSize = lang === 'en' ? '24px' : '36px';
                                const metaTop = lang === 'en' ? '22mm' : '14mm';
                                return (
                                <div key={page.month} className="print-page-container">
                                    <div className="print-header">
                                        <div className="print-title">{t.title}</div>
                                        <div className="print-subtitle">{t.print_subtitle}</div>
                                        <div className="print-meta" style={{ top: metaTop }}>
                                            <div className="print-meta-year">{year} {t.year}</div>
                                            <div className="print-meta-month" style={{fontSize: monthFontSize}}>{monthLabel} <span style={{fontSize:'16px', fontWeight:'normal'}}>{t.month}</span></div>
                                        </div>
                                    </div>
                                    <div className="table-wrapper">
                                        <table className="design-table">
                                            <thead>
                                                <tr>
                                                    <th style={{width: '12%'}}>{t.date_col}</th>
                                                    <th style={{width: '30%'}}>{t.daily_one}</th>
                                                    <th style={{width: '6%'}}>{t.check_col}</th>
                                                    <th style={{width: '46%'}}>{t.daily_ten}</th>
                                                    <th style={{width: '6%'}}>{t.check_col}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {page.plans.map((p, idx) => (
                                                    <tr key={p.date}>
                                                        <td className="cell-date">{parseInt(p.date.split('-')[2])} <span className="cell-weekday">{lang === 'en' ? WEEKDAY_MAP[p.weekday] : p.weekday}</span></td>
                                                        <td className="cell-scripture pl-2">{formatScriptureDisplay(p.dailyOne, lang)}</td>
                                                        <td className="cell-check"><div className="design-checkbox"></div></td>
                                                        <td className="cell-scripture text-gray-700 pl-2">{formatScriptureDisplay(p.dailyTen, lang)}</td>
                                                        <td className="cell-check"><div className="design-checkbox"></div></td>
                                                    </tr>
                                                ))}
                                                {Array.from({length: 31 - page.plans.length}).map((_, i) => (
                                                    <tr key={`empty-${i}`}>
                                                        <td className="cell-date text-gray-200">-</td><td></td><td className="cell-check"><div className="design-checkbox opacity-20"></div></td><td></td><td className="cell-check"><div className="design-checkbox opacity-20"></div></td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                    <div className="print-footer">
                                         <div>PJBC Bible Reading Schedule</div>
                                         <div className="flex items-center gap-1"><Fish size={12} /><span>æ°´æ·±ä¹‹è™•ï¼Œä¸‹ç¶²æ‰“é­š</span></div>
                                    </div>
                                </div>
                            )})}
                        </div>
                    </div>
                </div>
            );
        };

        const PrintModal = ({ isOpen, onClose, onConfirm, availableYears, lang }) => {
            const [selectedYear, setSelectedYear] = useState(new Date().getFullYear());
            const [selectedMonths, setSelectedMonths] = useState([]);
            const t = TRANSLATIONS[lang];

            if (!isOpen) return null;

            const toggleMonth = (m) => setSelectedMonths(prev => prev.includes(m) ? prev.filter(x => x !== m) : [...prev, m]);
            const selectAll = () => setSelectedMonths(Array.from({length:12}, (_,i)=>i+1));
            const deselectAll = () => setSelectedMonths([]);

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in no-print">
                    <div className="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden flex flex-col animate-in zoom-in-95 border border-gray-100">
                        <div className="p-5 pb-4 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                            <h3 className="font-bold text-lg text-gray-800 flex items-center gap-2"><Printer size={20} className="text-[#1E3A8A]" />{t.print_modal_title}</h3>
                            <button onClick={onClose} className="p-1 hover:bg-gray-200 rounded-full text-gray-500 transition-colors"><X size={20}/></button>
                        </div>
                        <div className="p-6 space-y-6">
                            <p className="text-sm text-gray-600 leading-relaxed bg-blue-50 p-3 rounded-lg border border-blue-100">{t.print_desc}</p>
                            <div>
                                <label className="block text-xs font-bold text-gray-500 mb-2 uppercase tracking-wider">{t.year}</label>
                                <div className="flex gap-2">
                                    {availableYears.map(y => (
                                        <button key={y} onClick={() => setSelectedYear(y)} className={`flex-1 py-2 rounded-lg font-bold border transition-all ${selectedYear === y ? 'bg-[#1E3A8A] text-white border-[#1E3A8A] shadow-md' : 'bg-white text-gray-600 border-gray-200 hover:bg-gray-50'}`}>{y}</button>
                                    ))}
                                </div>
                            </div>
                            <div>
                                <div className="flex justify-between items-center mb-2">
                                    <label className="block text-xs font-bold text-gray-500 uppercase tracking-wider">{t.month}</label>
                                    <div className="flex gap-2"><button onClick={selectAll} className="text-[10px] text-blue-600 hover:underline">{t.select_all}</button><button onClick={deselectAll} className="text-[10px] text-gray-400 hover:underline">{t.deselect_all}</button></div>
                                </div>
                                <div className="grid grid-cols-4 gap-2">
                                    {Array.from({length: 12}, (_, i) => i + 1).map(m => {
                                        const isSelected = selectedMonths.includes(m);
                                        return (
                                            <button key={m} onClick={() => toggleMonth(m)} className={`py-2 rounded-md text-sm font-medium transition-all flex flex-col items-center justify-center border ${isSelected ? 'bg-blue-100 text-blue-800 border-blue-300 ring-1 ring-blue-300' : 'bg-white text-gray-600 border-gray-200 hover:border-gray-300 hover:bg-gray-50'}`}>{m} <span className="text-[10px] opacity-70">{lang === 'zh' ? 'æœˆ' : ''}</span></button>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                        <div className="p-4 bg-gray-50 flex gap-3 border-t border-gray-100">
                            <button onClick={onClose} className="flex-1 py-2.5 rounded-lg border border-gray-300 text-gray-600 font-medium hover:bg-white hover:shadow-sm transition-all">{t.cancel}</button>
                            <button onClick={() => onConfirm(selectedYear, selectedMonths)} disabled={selectedMonths.length === 0} className="flex-1 py-2.5 rounded-lg bg-[#1E3A8A] text-white font-bold shadow-md hover:bg-blue-900 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center justify-center gap-2"><Eye size={18} />{t.print_preview_btn}</button>
                        </div>
                    </div>
                </div>
            );
        };

        const JourneyView = ({ starCount, lang }) => {
            const t = TRANSLATIONS[lang];
            const [activeSection, setActiveSection] = useState('characters'); // 'characters' or 'locations'
            
            const unlockedChars = JOURNEY_DATA.characters.filter(c => starCount >= c.stars);
            const lockedChars = JOURNEY_DATA.characters.filter(c => starCount < c.stars);
            
            const unlockedLocs = JOURNEY_DATA.locations.filter(l => starCount >= l.stars);
            const nextLockedLoc = JOURNEY_DATA.locations.find(l => starCount < l.stars);
            
            return (
                <div className="max-w-4xl mx-auto space-y-6 pb-24 animate-in slide-in-from-bottom-4 duration-500">
                    
                    {/* Header Card */}
                    <div className="bg-gradient-to-br from-[#1E3A8A] to-[#2563EB] text-white p-6 md:p-8 rounded-2xl shadow-lg relative overflow-hidden">
                        <div className="relative z-10">
                            <div className="flex items-center gap-2 text-blue-200 mb-1 font-medium">
                                <Milestone size={18} />
                                {t.journey_subtitle}
                            </div>
                            <h2 className="text-3xl font-bold mb-4">{t.journey_title}</h2>
                            <div className="flex items-end gap-3">
                                <div className="text-6xl font-black leading-none">{starCount}</div>
                                <div className="text-xl mb-1 opacity-90">{t.days_unit}</div>
                            </div>
                        </div>
                        <div className="absolute right-0 bottom-0 opacity-10">
                            <Map size={180} />
                        </div>
                    </div>

                    {/* Navigation Buttons */}
                    <div className="flex p-1 bg-gray-200/80 rounded-xl">
                        <button 
                            onClick={() => setActiveSection('characters')}
                            className={`flex-1 py-3 rounded-lg font-bold text-sm md:text-base flex items-center justify-center gap-2 transition-all ${
                                activeSection === 'characters' 
                                ? 'bg-white text-[#1E3A8A] shadow-sm ring-1 ring-gray-200' 
                                : 'text-gray-500 hover:text-gray-700'
                            }`}
                        >
                            <Award size={18} />
                            {t.character_unlock}
                        </button>
                        <button 
                            onClick={() => setActiveSection('locations')}
                            className={`flex-1 py-3 rounded-lg font-bold text-sm md:text-base flex items-center justify-center gap-2 transition-all ${
                                activeSection === 'locations' 
                                ? 'bg-white text-blue-600 shadow-sm ring-1 ring-gray-200' 
                                : 'text-gray-500 hover:text-gray-700'
                            }`}
                        >
                            <Map size={18} />
                            {t.location_map}
                        </button>
                    </div>

                    {/* 1. è–ç¶“äººç‰©è§£é–æ¦œ */}
                    {activeSection === 'characters' && (
                        <div className="animate-in fade-in slide-in-from-right-4 duration-300">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                {unlockedChars.length === 0 && (
                                    <div className="col-span-full py-12 text-center bg-white rounded-2xl border border-dashed border-gray-300 text-gray-400">
                                        <Sparkles size={32} className="mx-auto mb-2 opacity-50" />
                                        <p>æŒçºŒè®€ç¶“ï¼Œæ¯æ”¶é›† 3 é¡†æ˜Ÿæ˜Ÿè§£é–ä¸€ä½è–ç¶“äººç‰©...</p>
                                    </div>
                                )}

                                {unlockedChars.map(char => (
                                    <div key={char.id} className="bg-white p-5 rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden group">
                                        <div className="absolute top-0 right-0 p-3 opacity-5 group-hover:opacity-10 transition-opacity">
                                            <Award size={60} className="text-amber-500" />
                                        </div>
                                        <div className="flex items-start justify-between mb-4 relative z-10">
                                            <div className="flex-1 flex gap-3">
                                                {/* é ­åƒ */}
                                                <div className="shrink-0 mt-1">
                                                    {char.gender === 'm' ? <AvatarMale /> : <AvatarFemale />}
                                                </div>
                                                <div className="flex-1">
                                                    <div className="text-xs font-bold text-amber-600 uppercase tracking-wide mb-2">{char.theme}</div>
                                                    {/* äººç‰©åç¨±åŠ ä¸Šæ·ºè‰²å°ˆæ¥­æ„Ÿæ–¹å¡Šåº•è‰² */}
                                                    <div className="inline-block bg-indigo-50 px-4 py-2 rounded-lg border border-indigo-100">
                                                        <div className="text-2xl font-bold text-indigo-900 leading-none">{char.name}</div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div className="w-8 h-8 rounded-full bg-amber-50 flex items-center justify-center text-amber-600 font-bold text-xs shrink-0 ml-2">
                                                {char.stars}
                                            </div>
                                        </div>
                                        
                                        {/* ç¥ç¦èªç§»é™¤åº•è‰²è‰²å¡Šï¼Œä¿æŒä¹¾æ·¨ */}
                                        <div className="relative z-10 pl-1 mt-2">
                                            <p className="text-gray-900 leading-relaxed font-bold text-base">
                                                ã€Œ{char.blessing}ã€
                                            </p>
                                        </div>
                                    </div>
                                ))}

                                {lockedChars.length > 0 && (
                                    <div className="bg-gray-50 p-5 rounded-xl border border-gray-200 border-dashed flex items-center justify-center text-center opacity-70">
                                        <div>
                                            <Lock size={24} className="mx-auto text-gray-400 mb-2" />
                                            <div className="font-bold text-gray-500">ä¸‹ä¸€ä½è¦‹è­‰äºº</div>
                                            <div className="text-xs text-gray-400 mt-1">éœ€ç´¯ç© {lockedChars[0].stars} é¡†æ˜Ÿæ˜Ÿ</div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* 2. è–ç¶“åœ°åœ– */}
                    {activeSection === 'locations' && (
                        <div className="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden animate-in fade-in slide-in-from-right-4 duration-300">
                            <div className="p-5 border-b border-gray-100 flex items-center gap-2 bg-gray-50/50">
                                <Map className="text-blue-600" size={20} />
                                <h3 className="font-bold text-gray-800 text-lg">{t.location_map}</h3>
                            </div>
                            <div className="p-6">
                                <div className="space-y-0 relative">
                                    <div className="absolute left-[19px] top-4 bottom-4 w-0.5 bg-gray-200 z-0"></div>

                                    {unlockedLocs.length === 0 && (
                                        <div className="relative z-10 flex gap-4 pb-8">
                                            <div className="w-10 h-10 rounded-full bg-blue-100 border-4 border-white shadow-sm flex items-center justify-center shrink-0">
                                                <Anchor size={18} className="text-blue-600" />
                                            </div>
                                            <div className="pt-2">
                                                <div className="font-bold text-gray-800 text-lg">æ—…ç¨‹èµ·é»</div>
                                                <div className="text-sm text-gray-500 mt-1">ç´¯ç© 7 é¡†æ˜Ÿè§£é–ç¬¬ä¸€å€‹åœ°é»...</div>
                                            </div>
                                        </div>
                                    )}

                                    {unlockedLocs.map((loc, idx) => {
                                        const isCurrent = idx === unlockedLocs.length - 1;
                                        return (
                                            <div key={loc.id} className="relative z-10 flex gap-4 pb-8 last:pb-0 group">
                                                <div className={`w-10 h-10 rounded-full border-4 border-white shadow-sm flex items-center justify-center shrink-0 transition-colors ${isCurrent ? 'bg-blue-600 text-white ring-2 ring-blue-200' : 'bg-blue-100 text-blue-600'}`}>
                                                    {isCurrent ? <Map size={18} /> : <CheckCircle size={18} />}
                                                </div>
                                                <div className="pt-1 flex-1">
                                                    <div className="flex items-center gap-3 mb-1">
                                                        <div className={`font-bold text-lg ${isCurrent ? 'text-blue-700' : 'text-gray-800'}`}>
                                                            {loc.name}
                                                        </div>
                                                        {isCurrent && <span className="text-[10px] bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full font-bold">{t.current_pos}</span>}
                                                    </div>
                                                    <div className="text-sm text-gray-500 font-medium mb-2">{loc.theme}</div>
                                                    <div className="text-base text-gray-900 leading-relaxed font-bold bg-gray-50 p-3 rounded-lg border border-gray-100 group-hover:bg-blue-50/30 transition-colors">
                                                        {loc.meditation}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}

                                    {nextLockedLoc && (
                                        <div className="relative z-10 flex gap-4 pt-8">
                                            <div className="w-10 h-10 rounded-full bg-gray-100 border-4 border-white flex items-center justify-center shrink-0 grayscale opacity-70">
                                                <Lock size={16} className="text-gray-400" />
                                            </div>
                                            <div className="pt-2 opacity-60">
                                                <div className="font-bold text-gray-500 text-lg flex items-center gap-2">
                                                    {nextLockedLoc.name}
                                                    <span className="text-xs font-normal border border-gray-300 rounded px-1.5 py-0.5">{nextLockedLoc.stars} {t.days_unit}</span>
                                                </div>
                                                <div className="text-sm text-gray-400 mt-1">{t.locked}</div>
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        
        // --- è¼•é‡ç´š Toast å…ƒä»¶ ---
        const Toast = ({ message, subMessage, onClose, type = 'star' }) => {
            useEffect(() => {
                // å¦‚æœæœ‰å‰¯æ¨™é¡Œæ–‡å­—ï¼Œå»¶é•·é¡¯ç¤ºæ™‚é–“ä»¥ä¾¿é–±è®€
                const duration = subMessage ? 6000 : 4000;
                const timer = setTimeout(onClose, duration);
                return () => clearTimeout(timer);
            }, [onClose, subMessage]);

            const isUnlock = type === 'unlock';
            return (
                <div className={`fixed top-24 left-1/2 -translate-x-1/2 z-[100] w-max max-w-[90%] animate-fade-in-up px-6 py-4 rounded-xl shadow-2xl flex items-start gap-4 text-sm md:text-base border transition-colors ${
                    isUnlock 
                    ? "bg-gradient-to-r from-blue-900 to-indigo-900 text-white border-blue-400/30" 
                    : "bg-gray-800/95 backdrop-blur text-white border-white/10 items-center"
                }`}>
                    {isUnlock ? (
                        <div className="p-2 bg-amber-400 rounded-full text-blue-900 animate-bounce-short mt-1"><Gift size={20} /></div>
                    ) : (
                        <Star className="text-yellow-400 fill-yellow-400 shrink-0" size={20} />
                    )}
                    <div className="flex flex-col text-left">
                        <span className={isUnlock ? "font-bold text-amber-300 text-xs mb-0.5" : "hidden"}>{isUnlock ? "çå‹µé€šçŸ¥" : ""}</span>
                        <span className={isUnlock ? "font-bold text-lg leading-tight" : ""}>{message}</span>
                        {subMessage && (
                            <span className="text-sm font-bold mt-2 font-serif-tc border-t border-white/20 pt-2 block leading-relaxed text-white">
                                ã€Œ{subMessage}ã€
                            </span>
                        )}
                    </div>
                </div>
            );
        };

        function App() {
            const [activeTab, setActiveTab] = useState('home');
            const [lang, setLang] = useState('zh'); 
            const [plans, setPlans] = useState([]);
            const [userState, setUserState] = useState({
                readStatus: {},
                notes: {}
            });
            const [selectedDate, setSelectedDate] = useState(null);
            const [loading, setLoading] = useState(true);
            const [currentCalendarDate, setCurrentCalendarDate] = useState(new Date());
            
            // Print State
            const [isPrintModalOpen, setIsPrintModalOpen] = useState(false);
            const [printPreviewData, setPrintPreviewData] = useState(null);
            
            // Toast State
            const [toast, setToast] = useState(null); // { msg, type, subMsg }

            const t = TRANSLATIONS[lang];

            useEffect(() => {
                const loadData = () => {
                    const initial = generateInitialData();
                    setPlans(initial);
                    const savedUser = localStorage.getItem('pjbc_user');
                    if (savedUser) setUserState(JSON.parse(savedUser));
                    setLoading(false);
                };
                loadData();
            }, []);

            useEffect(() => {
                if (!loading) localStorage.setItem('pjbc_user', JSON.stringify(userState));
            }, [userState, loading]);

            // è¨ˆç®—æ˜Ÿæ˜Ÿç¸½æ•¸
            const starCount = Object.values(userState.readStatus).filter(Boolean).length;

            const toggleRead = (date) => {
                const isCurrentlyRead = !!userState.readStatus[date];
                
                // å¦‚æœæ˜¯æ¨™è¨˜ç‚ºå·²è®€ï¼ˆå¢åŠ æ˜Ÿæ˜Ÿï¼‰
                if (!isCurrentlyRead) {
                    const newCount = starCount + 1;
                    
                    // æª¢æŸ¥æ˜¯å¦è§£é–æ–°æˆå°±
                    // äººç‰©ï¼š3, 6, 9...
                    const unlockedChar = JOURNEY_DATA.characters.find(c => c.stars === newCount);
                    // åœ°é»ï¼š7, 14, 21...
                    const unlockedLoc = JOURNEY_DATA.locations.find(l => l.stars === newCount);

                    if (unlockedChar) {
                        setToast({ 
                            msg: `${t.unlock_toast}è¦‹è­‰äººã€Œ${unlockedChar.name}ã€`, 
                            subMsg: unlockedChar.blessing,
                            type: 'unlock' 
                        });
                    } else if (unlockedLoc) {
                        setToast({ 
                            msg: `${t.unlock_toast}åœ°é»ã€Œ${unlockedLoc.name}ã€`, 
                            subMsg: unlockedLoc.meditation,
                            type: 'unlock' 
                        });
                    } else {
                        setToast({ msg: t.star_toast, type: 'star' });
                    }
                }
                
                setUserState(prev => ({ ...prev, readStatus: { ...prev.readStatus, [date]: !isCurrentlyRead } }));
            };
            
            const handlePrintClick = () => setIsPrintModalOpen(true);
            const handlePreviewConfirm = (year, months) => {
                setIsPrintModalOpen(false);
                setPrintPreviewData({ year, selectedMonths: months });
            };
            const closePreview = () => setPrintPreviewData(null);

            const DetailCard = ({ date, onNavigate }) => {
                const plan = plans.find(p => p.date === date);
                const [readingQuery, setReadingQuery] = useState(null);
                
                useEffect(() => { setReadingQuery(null); }, [date]);

                if (!plan) return <div className="p-10 text-center text-gray-500">{t.no_data}</div>;
                const isRead = userState.readStatus[date];
                const dailyOneReadings = parseScriptureString(plan.dailyOne);
                const dailyTenReadings = parseScriptureString(plan.dailyTen);
                
                const handlePrev = () => {
                    const d = new Date(date); d.setDate(d.getDate() - 1);
                    onNavigate(d.toISOString().split('T')[0]);
                };
                const handleNext = () => {
                    const d = new Date(date); d.setDate(d.getDate() + 1);
                    onNavigate(d.toISOString().split('T')[0]);
                };

                const renderButtons = (readings, source) => (
                    <div className="flex flex-wrap gap-2 mt-2">
                        {readings.map((r, idx) => {
                            const isSelected = readingQuery && readingQuery.bookId === r.bookId && readingQuery.chapter === r.chapter && readingQuery.source === source;
                            const label = getButtonLabel(r, lang);
                            return (
                                <button key={idx} onClick={() => setReadingQuery(isSelected ? null : { ...r, source, label })} className={`text-xs px-3 py-1.5 rounded-full border flex items-center gap-1 transition-colors ${isSelected ? "bg-blue-600 text-white border-blue-600 shadow-md" : "bg-white text-blue-600 border-blue-200 hover:bg-blue-50"}`}>
                                    {isSelected ? <X size={12}/> : <Book size={12}/>} {label}
                                </button>
                            );
                        })}
                    </div>
                );
                return (
                    <div className="space-y-6">
                        <div className="flex items-center justify-between">
                            <button onClick={handlePrev} className="p-2 hover:bg-gray-100 rounded-full text-gray-400 hover:text-blue-600 transition-colors"><ChevronLeft size={28} /></button>
                            <div className="text-center">
                                <h2 className="text-3xl font-bold text-[#1E3A8A] mb-1">{parseInt(date.split('-')[1])} / {parseInt(date.split('-')[2])} <span className="text-lg ml-2 font-medium text-gray-500">({lang === 'en' ? WEEKDAY_MAP[plan.weekday] : plan.weekday})</span></h2>
                                <div className="text-gray-400 font-medium">{date.split('-')[0]}</div>
                            </div>
                            <button onClick={handleNext} className="p-2 hover:bg-gray-100 rounded-full text-gray-400 hover:text-blue-600 transition-colors"><ChevronRight size={28} /></button>
                        </div>
                        <div className="flex justify-center">
                             <button onClick={() => toggleRead(date)} className={`w-full max-w-xs py-3 rounded-full flex items-center justify-center gap-2 font-bold transition-all shadow-md transform hover:scale-[1.02] active:scale-95 ${isRead ? "bg-green-500 text-white shadow-green-200 ring-2 ring-green-100" : "bg-white border-2 border-gray-200 text-gray-600 hover:border-blue-300 hover:text-blue-600"}`}>
                                {isRead ? <CheckCircle size={22} /> : <Circle size={22} />}{isRead ? t.marked : t.mark_read}
                             </button>
                        </div>
                        <div className="flex flex-col gap-4">
                             <div className="bg-blue-50/50 p-4 rounded-xl border border-blue-100 relative group hover:border-blue-200 transition-all">
                                <div className="absolute right-0 top-0 p-2 opacity-10"><BookOpen size={40} className="text-[#1E3A8A]" /></div>
                                <div className="text-xs text-blue-600 font-bold mb-1">{t.daily_one}</div>
                                <div className="text-lg font-bold text-gray-800">{formatScriptureDisplay(plan.dailyOne, lang)}</div>
                                {renderButtons(dailyOneReadings, 'one')}
                                {readingQuery && readingQuery.source === 'one' && (<BibleReader bookId={readingQuery.bookId} chapter={readingQuery.chapter} label={readingQuery.label} lang={lang} />)}
                             </div>
                             <div className="bg-orange-50/50 p-4 rounded-xl border border-orange-100 relative group hover:border-orange-200 transition-all">
                                <div className="absolute right-0 top-0 p-2 opacity-10"><Sparkles size={40} className="text-[#D97706]" /></div>
                                <div className="text-xs text-orange-600 font-bold mb-1">{t.daily_ten}</div>
                                <div className="text-lg font-bold text-gray-800 leading-snug">{formatScriptureDisplay(plan.dailyTen, lang)}</div>
                                {renderButtons(dailyTenReadings, 'ten')}
                                {readingQuery && readingQuery.source === 'ten' && (<BibleReader bookId={readingQuery.bookId} chapter={readingQuery.chapter} label={readingQuery.label} lang={lang} />)}
                             </div>
                        </div>
                    </div>
                );
            };

            const CalendarView = ({ currentDate, setCurrentDate }) => {
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth() + 1;
                const daysInMonth = new Date(year, month, 0).getDate();
                const firstDay = new Date(year, month - 1, 1).getDay();
                const weekdays = lang === 'zh' ? ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"] : ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
                return (
                    <div className="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden h-full flex flex-col">
                        <div className="p-4 flex items-center justify-between border-b border-gray-100 bg-gray-50/50">
                            <h2 className="font-bold text-lg text-gray-800 flex items-center gap-2"><CalendarIcon size={20} className="text-[#1E3A8A]"/>{year} / {month}</h2>
                            <div className="flex gap-1">
                                <button onClick={() => setCurrentDate(new Date(year, month - 2, 1))} className="p-1 hover:bg-gray-200 rounded-lg text-gray-500"><ChevronLeft size={20}/></button>
                                <button onClick={() => setCurrentDate(new Date(year, month, 1))} className="p-1 hover:bg-gray-200 rounded-lg text-gray-500"><ChevronRight size={20}/></button>
                            </div>
                        </div>
                        <div className="grid grid-cols-7 text-center border-b border-gray-100 bg-gray-50/30">
                            {weekdays.map(d => <div key={d} className="py-3 text-xs font-bold text-gray-400">{d}</div>)}
                        </div>
                        <div className="grid grid-cols-7 auto-rows-fr flex-1">
                            {Array.from({ length: firstDay }).map((_, i) => <div key={`empty-${i}`} className="min-h-[80px] bg-gray-50/10 border-r border-b border-gray-100 last:border-r-0" />)}
                            {Array.from({ length: daysInMonth }).map((_, i) => {
                                const d = i + 1;
                                const dateStr = `${year}-${String(month).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                                const plan = plans.find(p => p.date === dateStr);
                                const isRead = userState.readStatus[dateStr];
                                const isToday = new Date().toISOString().split('T')[0] === dateStr;
                                return (
                                    <div key={dateStr} onClick={() => setSelectedDate(dateStr)} className={`min-h-[80px] p-2 border-r border-b border-gray-100 cursor-pointer transition-all hover:bg-blue-50/50 relative group ${isToday ? 'bg-blue-50/20' : ''}`}>
                                        <div className="flex justify-between items-start mb-1">
                                            <span className={`text-sm w-7 h-7 flex items-center justify-center rounded-full font-bold transition-all ${isToday ? 'bg-[#1E3A8A] text-white shadow-md' : 'text-gray-600 group-hover:bg-gray-200'}`}>{d}</span>
                                            {isRead && <CheckCircle size={16} className="text-green-500" />}
                                        </div>
                                        {plan ? (
                                            <div className="space-y-1 mt-2">
                                                <div className="text-[9px] text-[#1E3A8A] font-medium bg-blue-100/40 px-1.5 py-0.5 rounded leading-tight truncate">{formatCalendarDisplay(plan.dailyOne, lang)}</div>
                                                <div className="hidden md:block text-[9px] text-gray-500 px-1 mt-0.5 leading-tight truncate">{formatCalendarDisplay(plan.dailyTen, lang)}</div>
                                            </div>
                                        ) : <span className="text-[10px] text-gray-300"></span>}
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                );
            };

            const TableView = () => {
                const [search, setSearch] = useState("");
                const [filterYear, setFilterYear] = useState(currentCalendarDate.getFullYear());
                const [filterMonth, setFilterMonth] = useState(currentCalendarDate.getMonth() + 1);
                const handlePrevMonth = () => { if (filterMonth === 1) { setFilterMonth(12); setFilterYear(prev => prev - 1); } else { setFilterMonth(prev => prev - 1); } };
                const handleNextMonth = () => { if (filterMonth === 12) { setFilterMonth(1); setFilterYear(prev => prev + 1); } else { setFilterMonth(prev => prev + 1); } };
                const filtered = useMemo(() => {
                    const prefix = `${filterYear}-${String(filterMonth).padStart(2,'0')}`;
                    return plans.filter(p => p.date.startsWith(prefix) && (p.dailyOne.includes(search) || p.dailyTen.includes(search)));
                }, [plans, filterYear, filterMonth, search]);
                return (
                    <div className="space-y-4 max-w-4xl mx-auto pb-24">
                        <div className="bg-white p-4 rounded-xl border border-gray-200 sticky top-0 z-20 shadow-sm flex flex-col md:flex-row gap-4 no-print">
                            <div className="flex items-center gap-2 justify-between md:justify-start">
                                <button onClick={handlePrevMonth} className="p-2 hover:bg-gray-100 rounded-lg text-gray-500 transition-colors border border-transparent hover:border-gray-200"><ChevronLeft size={20} /></button>
                                <div className="flex gap-2">
                                    <select value={filterYear} onChange={e => setFilterYear(Number(e.target.value))} className="bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-100">{[2025, 2026, 2027].map(y => <option key={y} value={y}>{y}</option>)}</select>
                                    <select value={filterMonth} onChange={e => setFilterMonth(Number(e.target.value))} className="bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-100">{Array.from({length:12}).map((_,i) => <option key={i+1} value={i+1}>{i+1}æœˆ</option>)}</select>
                                </div>
                                <button onClick={handleNextMonth} className="p-2 hover:bg-gray-100 rounded-lg text-gray-500 transition-colors border border-transparent hover:border-gray-200"><ChevronRight size={20} /></button>
                            </div>
                            <div className="relative flex-1">
                                <Search className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400" size={16}/><input type="text" placeholder="Search..." className="w-full pl-9 pr-4 py-2 bg-gray-50 border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-100" value={search} onChange={e => setSearch(e.target.value)} />
                            </div>
                        </div>
                        <div className="space-y-3 no-print">
                            {filtered.length === 0 && <div className="text-center py-10 text-gray-400">ç„¡è³‡æ–™</div>}
                            {filtered.map(p => (
                                <div key={p.date} onClick={() => setSelectedDate(p.date)} className="bg-white p-4 rounded-xl border border-gray-200 flex items-center gap-4 hover:border-blue-300 cursor-pointer group transition-all hover:shadow-sm">
                                    <div className="w-14 text-center shrink-0"><div className="text-xl font-bold text-gray-700">{p.date.split('-')[2]}</div><div className="text-xs text-gray-400">({lang === 'en' ? WEEKDAY_MAP[p.weekday] : p.weekday})</div></div>
                                    <div className="flex-1 grid grid-cols-1 md:grid-cols-2 gap-1 md:gap-4">
                                        <div><span className="text-[10px] text-gray-400 font-bold uppercase">{t.daily_one}</span><div className="text-[#1E3A8A] font-medium text-sm group-hover:text-blue-700">{formatScriptureDisplay(p.dailyOne, lang)}</div></div>
                                        <div><span className="text-[10px] text-gray-400 font-bold uppercase">{t.daily_ten}</span><div className="text-gray-600 text-sm group-hover:text-gray-800">{formatScriptureDisplay(p.dailyTen, lang)}</div></div>
                                    </div>
                                    <div className="shrink-0 text-gray-300">{userState.readStatus[p.date] ? <CheckCircle size={20} className="text-green-500" /> : <ChevronRight size={20} />}</div>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            };

            const PreviewPortal = ({ children }) => {
                const mountNode = document.getElementById('print-preview-root');
                return createRoot(mountNode).render(children);
            };

            useEffect(() => {
                const mountNode = document.getElementById('print-preview-root');
                if (printPreviewData && mountNode) {
                    const root = createRoot(mountNode);
                    root.render(<PrintPreviewOverlay year={printPreviewData.year} selectedMonths={printPreviewData.selectedMonths} plans={plans} lang={lang} onClose={closePreview} />);
                    return () => setTimeout(() => root.unmount(), 0);
                }
            }, [printPreviewData, plans, lang]);
            
            if (loading) return <div className="h-screen flex items-center justify-center text-[#1E3A8A] font-bold">Loading...</div>;

            return (
                <div className="min-h-screen bg-[#F9F9F7] text-[#374151] pb-20 md:pb-0 md:pt-20">
                    {/* Toast æç¤º */}
                    {toast && <Toast message={toast.msg} subMessage={toast.subMsg} type={toast.type} onClose={() => setToast(null)} />}

                    {printPreviewData && <PrintPreviewOverlay year={printPreviewData.year} selectedMonths={printPreviewData.selectedMonths} plans={plans} lang={lang} onClose={closePreview} />}

                    <nav className="fixed bottom-0 md:top-0 md:bottom-auto left-0 w-full bg-white/90 backdrop-blur-md border-t md:border-b border-gray-200 z-40 px-6 py-2 md:py-3 shadow-lg md:shadow-sm no-print">
                        <div className="max-w-5xl mx-auto flex justify-between items-center">
                            <div className="hidden md:flex items-center gap-3"><div className="w-9 h-9 rounded-lg bg-[#1E3A8A] flex items-center justify-center text-white font-bold text-lg shadow-sm">P</div><span className="text-xl font-bold tracking-tight text-[#1E3A8A]">PJBC</span></div>
                            <div className="flex w-full md:w-auto justify-around md:gap-8">
                                {[
                                    {id:'home',icon:Home,label:t.nav.home},
                                    {id:'calendar',icon:CalendarIcon,label:t.nav.calendar},
                                    {id:'table',icon:List,label:t.nav.table},
                                    {id:'journey',icon:Map,label:t.nav.journey}
                                ].map(i => (
                                    <button key={i.id} onClick={() => setActiveTab(i.id)} className={`flex flex-col md:flex-row items-center gap-1 md:gap-2 p-2 rounded-xl transition-all ${activeTab === i.id ? "text-[#1E3A8A] bg-blue-50 font-semibold" : "text-gray-400 hover:text-[#1E3A8A] hover:bg-gray-50"}`}>
                                        <i.icon size={22} strokeWidth={activeTab === i.id ? 2.5 : 2} /><span className="text-[10px] md:text-sm">{i.label}</span>
                                    </button>
                                ))}
                            </div>
                        </div>
                    </nav>

                    <main className="p-4 md:p-8 max-w-6xl mx-auto no-print">
                        {activeTab === 'home' && (
                            <div className="space-y-6 animate-in slide-in-from-bottom-4 duration-500">
                                <div className="flex flex-col gap-4">
                                    <div className="flex justify-between items-start">
                                        <div>
                                            <div className="text-[#D97706] font-bold text-sm mb-1 flex items-center gap-2">
                                                <Fish size={16} /> 
                                                {lang === 'zh' ? "æ°´æ·±ä¹‹è™•ï¼Œä¸‹ç¶²æ‰“é­š" : "Launch out into the deep"}
                                            </div>
                                            <h1 className="text-2xl md:text-4xl font-bold text-[#1E3A8A] tracking-tight leading-snug">
                                                {t.title}<br/>{t.subtitle}
                                            </h1>
                                        </div>
                                        <div className="flex flex-col items-end gap-2">
                                            <div className="flex gap-2">
                                                <button onClick={handlePrintClick} className="flex items-center gap-1 text-xs font-bold border border-gray-300 bg-white rounded-full px-3 py-1 shadow-sm hover:bg-gray-50 transition-all text-gray-800">
                                                    <Printer size={14} /> {t.print_btn}
                                                </button>
                                                <button onClick={() => setLang(l => l === 'zh' ? 'en' : 'zh')} className="flex items-center gap-1 text-xs font-bold border border-gray-300 bg-white rounded-full px-3 py-1 shadow-sm hover:bg-gray-50 transition-all text-gray-600"><Globe size={14} /> {lang === 'zh' ? 'EN' : 'ä¸­'}</button>
                                            </div>
                                            <button onClick={() => { const now = new Date(); setSelectedDate(now.toISOString().split('T')[0]); setCurrentCalendarDate(now); }} className="bg-[#1E3A8A] text-white px-6 py-3 rounded-xl font-bold shadow-lg hover:shadow-xl hover:bg-blue-900 hover:scale-105 transition-all flex items-center gap-2 text-base whitespace-nowrap"><BookOpen size={20} /> {t.today_btn}</button>
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-2 gap-3 md:flex md:gap-4">
                                        <div className="bg-white p-3 rounded-xl border border-gray-200 shadow-sm flex items-center gap-3 flex-1 cursor-default transition-all group">
                                            <div className="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center group-hover:bg-blue-100"><Star size={20} className="text-[#1E3A8A] fill-[#1E3A8A]" /></div>
                                            <div>
                                                <div className="text-xs text-gray-500">{t.days_read}</div>
                                                <div className="font-bold text-[#1E3A8A] flex items-baseline gap-1 leading-tight">{starCount} <span className="text-xs font-normal text-gray-400">{t.days_unit}</span></div>
                                                <div className="text-[11px] text-gray-400 font-medium mt-0.5">{lang === 'zh' ? `å·²è®€ ${starCount} å¤©` : `${starCount} days read`}</div>
                                            </div>
                                        </div>
                                        {/* ä¿®æ”¹ï¼šå°‡ã€Œå®Œæ•´é€²åº¦è¡¨ã€æŒ‰éˆ•æ›¿æ›ç‚ºã€Œæˆ‘çš„æ—…ç¨‹ã€æŒ‰éˆ• */}
                                        <div className="bg-gradient-to-r from-amber-50 to-orange-50 p-3 rounded-xl border border-orange-200 shadow-sm flex items-center gap-3 flex-1 cursor-pointer hover:shadow-md transition-all group" onClick={() => setActiveTab('journey')}>
                                            <div className="w-10 h-10 rounded-full bg-white flex items-center justify-center text-amber-600 shadow-sm group-hover:scale-110 transition-transform"><Award size={20} /></div>
                                            <div><div className="text-xs text-amber-600 font-bold uppercase tracking-wide">{t.journey_title}</div><div className="font-bold text-gray-800 text-sm group-hover:text-amber-800">{t.view_journey} <span className="inline-block transition-transform group-hover:translate-x-1">â†’</span></div></div>
                                        </div>
                                    </div>
                                </div>
                                <div className="w-full">
                                    <CalendarView currentDate={currentCalendarDate} setCurrentDate={setCurrentCalendarDate} />
                                </div>
                            </div>
                        )}
                        {activeTab === 'calendar' && <div className="max-w-5xl mx-auto animate-in fade-in h-[calc(100vh-140px)]"><CalendarView currentDate={currentCalendarDate} setCurrentDate={setCurrentCalendarDate} /></div>}
                        {activeTab === 'table' && <div className="animate-in fade-in"><TableView /></div>}
                        {activeTab === 'journey' && <div className="animate-in fade-in"><JourneyView starCount={starCount} lang={lang} /></div>}
                    </main>

                    {selectedDate && (
                        <div className="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm transition-opacity no-print">
                            <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto animate-in fade-in zoom-in-95 duration-200 flex flex-col">
                                <div className="sticky top-0 bg-white/95 backdrop-blur z-20 flex justify-end p-3 border-b border-gray-100"><button onClick={() => { setSelectedDate(null); }} className="p-2 hover:bg-gray-100 rounded-full text-gray-500"><X size={24} /></button></div>
                                <div className="p-6 pt-2 overflow-y-auto custom-scrollbar"><DetailCard date={selectedDate} onNavigate={setSelectedDate} /></div>
                            </div>
                        </div>
                    )}
                    
                    <PrintModal isOpen={isPrintModalOpen} onClose={() => setIsPrintModalOpen(false)} onConfirm={handlePreviewConfirm} availableYears={[2025, 2026]} lang={lang} />
                </div>
            );
        }

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
